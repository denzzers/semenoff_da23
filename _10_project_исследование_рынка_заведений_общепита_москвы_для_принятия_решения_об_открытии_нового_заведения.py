# -*- coding: utf-8 -*-
"""#10_Project_–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ä—ã–Ω–∫–∞ –∑–∞–≤–µ–¥–µ–Ω–∏–π –æ–±—â–µ–ø–∏—Ç–∞ –ú–æ—Å–∫–≤—ã –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏—è –æ–± –æ—Ç–∫—Ä—ã—Ç–∏–∏ –Ω–æ–≤–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏—è.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/github/denzzers/semenoff_da23/blob/main/%2310_Project_%D0%98%D1%81%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D1%80%D1%8B%D0%BD%D0%BA%D0%B0%20%D0%B7%D0%B0%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D0%B9%20%D0%BE%D0%B1%D1%89%D0%B5%D0%BF%D0%B8%D1%82%D0%B0%20%D0%9C%D0%BE%D1%81%D0%BA%D0%B2%D1%8B%20%D0%B4%D0%BB%D1%8F%20%D0%BF%D1%80%D0%B8%D0%BD%D1%8F%D1%82%D0%B8%D1%8F%20%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BE%D0%B1%20%D0%BE%D1%82%D0%BA%D1%80%D1%8B%D1%82%D0%B8%D0%B8%20%D0%BD%D0%BE%D0%B2%D0%BE%D0%B3%D0%BE%20%D0%B7%D0%B0%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D1%8F.ipynb

# –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ä—ã–Ω–∫–∞ –∑–∞–≤–µ–¥–µ–Ω–∏–π –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –ú–æ—Å–∫–≤—ã

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#Description)
2. [–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –¥–∞–Ω–Ω—ã–º](#General_information)
3. [–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö](#Data_preprocassing) \
    3.1. [–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ—è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤](#Validation_new_dublicates) \
    3.2. [–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤](#Processing_of_omissions) \
    3.3. [–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö](#Changing_data_types) \
    3.4. [–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ –≤ –¥–∞—Ç–∞—Å–µ—Ç](#Adding_columns_to_dataset)
4. [–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö](#Data_Analysis) \
    4.1. [–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π](#Categories) \
    4.2. [–ö–æ–ª-–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∑–∞–≤–µ–¥–µ–Ω–∏–π](#Number_of_seats) \
    4.3. [–ò–∑—É—á–µ–Ω–∏–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π](#Network_network) \
    4.4. [–¢–æ–ø –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å–µ—Ç–µ–π –≤ –ú–æ—Å–∫–≤–µ](#Top_network) \
    4.5. [–ò–∑—É—á–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ –ú–æ—Å–∫–≤—ã](#Districts) \
    4.6. [–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º](#Ratings) \
    4.7. [–§–æ–Ω–æ–≤–∞—è –∫–∞—Ä—Ç–æ–≥—Ä–∞–º–º–∞ —Å–æ —Å—Ä–µ–¥–Ω–∏–º —Ä–µ–π—Ç–∏–Ω–≥–æ–º –∑–∞–≤–µ–¥–µ–Ω–∏–π –∫–∞–∂–¥–æ–≥–æ —Ä–∞–π–æ–Ω–∞](#Horoplet) \
    4.8. [–í—Å–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞](#All_zavedeniya) \
    4.9. [–¢–æ–ø-15 —É–ª–∏—Ü –ø–æ –∫–æ–ª-–≤—É –∑–∞–≤–µ–¥–µ–Ω–∏–π](#Top-15_ulits) \
    4.10. [–ú–µ–¥–∏–∞–Ω–∞ —Å—Ä–µ–¥–Ω–∏—Ö —á–µ–∫–æ–≤ –∑–∞–≤–µ–¥–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–π–æ–Ω–∞](#Sredniy_chek)
5. [–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è: –æ—Ç–∫—Ä—ã—Ç–∏–µ –∫–æ—Ñ–µ–π–Ω–∏](#Opening_of_the_coffee_shop) \
    5.1. [–ö–æ—Ñ–µ–π–Ω–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞](#Dataset_coffee_shops) \
    5.2. [–ö—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω—ã–µ –∫–æ—Ñ–µ–π–Ω–∏](#Round-the-clock) \
    5.3. [–†–µ–π—Ç–∏–Ω–≥–∏ –∫–æ—Ñ–µ–µ–Ω](#Rating_of_coffee_shops) \
    5.4. [–°—Ç–æ–∏–º–æ—Å—Ç–∏ —á–∞—à–∫–∏ –∫–∞–ø—É—á–∏–Ω–æ](#Cup)

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
<a id='Description'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

***
–ò–Ω–≤–µ—Å—Ç–æ—Ä—ã –∏–∑ —Ñ–æ–Ω–¥–∞ ¬´Shut Up and Take My Money¬ª —Ä–µ—à–∏–ª–∏ –æ—Ç–∫—Ä—ã—Ç—å –∑–∞–≤–¥–µ–Ω–∏–µ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –≤ –ú–æ—Å–∫–≤–µ. –ù–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ –µ—â–µ –Ω–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å—Å—è - –∫–∞—Ñ–µ, —Ä–µ—Å—Ç–æ—Ä–∞–Ω –∏ —Ç.–ø., –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –º–µ—Å—Ç–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ, –º–µ–Ω—é, –∞ —Ç–∞–∫–∂–µ —Ü–µ–Ω—ã.

–î–ª—è –Ω–∞—á–∞–ª–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ä—ã–Ω–∫–∞ –ú–æ—Å–∫–≤—ã, –Ω–∞–π—Ç–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–µ–∑–µ–Ω—Ç–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤ –±—É–¥—É—â–µ–º –ø–æ–º–æ–≥—É—Ç –≤ –≤—ã–±–æ—Ä–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞–º –º–µ—Å—Ç–∞.

–ù–∞–º –¥–æ—Å—Ç—É–ø–µ–Ω –¥–∞—Ç–∞—Å–µ—Ç —Å –∑–∞–≤–µ–¥–µ–Ω–∏—è–º–∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –ú–æ—Å–∫–≤—ã, —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç—ã –∏ –Ø–Ω–¥–µ–∫—Å –ë–∏–∑–Ω–µ—Å –Ω–∞ –ª–µ—Ç–æ 2022 –≥–æ–¥–∞. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —Ä–∞–∑–º–µ—â—ë–Ω–Ω–∞—è –≤ —Å–µ—Ä–≤–∏—Å–µ –Ø–Ω–¥–µ–∫—Å –ë–∏–∑–Ω–µ—Å, –º–æ–≥–ª–∞ –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏–ª–∏ –Ω–∞–π–¥–µ–Ω–∞ –≤ –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö. –û–Ω–∞ –Ω–æ—Å–∏—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —Å–ø—Ä–∞–≤–æ—á–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä.
***
"""

# Commented out IPython magic to ensure Python compatibility.
# –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
# %matplotlib inline

import seaborn as sns

import folium
from folium import Map, Choropleth, Marker
from folium.plugins import MarkerCluster
from folium.plugins import FastMarkerCluster
from folium.features import CustomIcon

import plotly.express as px
from plotly import graph_objects as go
#import plotly.io as pio
#from IPython.display import Image

from google.colab import drive
drive.mount('/content/drive')

#import warnings
#warnings.filterwarnings("ignore")

"""## –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –¥–∞–Ω–Ω—ã–º
<a id='General_information'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

–ò–∑—É—á–∏–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –Ω–∞–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –ø—Ä–æ–≤–µ—Ä–∏–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã, –ø—Ä–æ–ø—É—Å–∫–∏, –ø—Ä–æ–≤–µ—Ä–∏–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–∏–º —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.
"""

# –æ—Ç–∫—Ä–æ–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∑–∞–ø–∏—à–µ–º –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
try:
    catering = pd.read_csv('/datasets/moscow_places.csv')
except:
    catering = pd.read_csv('/content/drive/MyDrive/datasets_YaP/moscow_places.csv')

# –≤—ã–≤–µ–¥–∏–º head –∏ tail –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
catering

# –≤—ã–≤–µ–¥–µ–º –æ–±—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –¥–∞—Ç–∞—Å–µ—Ç—É
catering.info()

"""<b>–ü–æ–¥–∏—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–º—É –¥–∞—Ç–∞—Å–µ—Ç—É –º—ã –≤–∏–¥–∏–º —Å–ª–µ–¥—É—é—â—É—é –∫–∞—Ä—Ç–∏–Ω—É:
- –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ 8406 –ø–æ–∑–∏—Ü–∏–π –ø–æ –ú–æ—Å–∫–≤–µ;
- –≤ –Ω–∞—à–µ–º —Ä–∞—Å–ø–æ—Ä—è–∂–µ–Ω–∏–∏ —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:
    - —Ç–∏–ø –æ–±—ä–µ–∫—Ç–∞ `object`:
        - `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è;
        - `category` - –∫–∞—Ç–µ–≥–æ—Ä–∏—è (–∫–∞—Ñ–µ, —Ä–µ—Å—Ç–æ—Ä–∞–Ω, –ø–∏—Ü—Ü–µ—Ä–∏—è –∏ —Ç.–ø.) –∑–∞–≤–µ–¥–µ–Ω–∏—è;
        - `address` - –∞–¥—Ä–µ—Å –∑–∞–≤–µ–¥–µ–Ω–∏—è;
        - `district` - —Ä–∞–π–æ–Ω –∑–∞–≤–µ–¥–µ–Ω–∏—è, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–æ;
        - `hours` - –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã (—á–∞—Å—ã –∏ –¥–Ω–∏ –∏ –Ω–µ–¥–µ–ª–∏) –∑–∞–≤–µ–¥–µ–Ω–∏—è;
        - `price` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ü–µ–Ω –∑–∞–≤–µ–¥–µ–Ω–∏—è;
        - `avg_bill` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è;
    - —Ç–∏–ø –æ–±—ä–µ–∫—Ç–∞ `float64`:
        - `lat` - —à–∏—Ä–æ—Ç–∞ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π —Ç–æ—á–∫–∏ –∑–∞–≤–µ–¥–µ–Ω–∏—è;
        - `lng` - –¥–æ–ª–≥–æ—Ç–∞ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π —Ç–æ—á–∫–∏ –∑–∞–≤–µ–¥–µ–Ω–∏—è;
        - `rating` - —Ä–µ–π—Ç–∏–Ω–≥ –∑–∞–≤–µ–¥–µ–Ω–∏—è –ø–æ –æ—Ü–µ–Ω–∫–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç–∞—Ö;
        - `middle_avg_bill` - —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∑–∞–≤–µ–¥–µ–Ω–∏—è;
        - `middle_coffee_cup` - —Å—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —á–∞—à–∫–∏ –∫–∞–ø—É—á–∏–Ω–æ –≤ –∑–∞–≤–µ–¥–µ–Ω–∏–∏;
        - `seats` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –≤ –∑–∞–≤–µ–¥–µ–Ω–∏–∏;
    - —Ç–∏–ø –æ–±—ä–µ–∫—Ç–∞ `int64`:
        - `chain` - –ø—Ä–∏–∑–Ω–∞–∫, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–µ–º —Å–µ—Ç–µ–≤—ã–º (1) –∏–ª–∏ –Ω–µ—Ç (0).
- –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∏—Ç–æ–æ–±—Ä–∞–∑–Ω—ã–π –≤–∏–¥;
- –≤ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–µ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:
    - –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–ª–æ–Ω–∫–∞ `name` –∏ `address` –ø—Ä–∏–≤–µ—Å—Ç–∏ —Å –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –¥–ª—è –±–æ–ª–µ–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã;
    - –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫–æ–ª–æ–Ω–∫–∏ `middle_avg_bill`, `middle_coffee_cup`, `seats` –∫ —Ç–∏–ø—É `int64` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö;
    - –≤ –∫–æ–ª–æ–Ω–∫–∞ `hours`, `price`, `avg_bill`, `middle_avg_bill`, `middle_coffee_cup`, `seats` –∏–º–µ—é—Ç—Å—è –ø—Ä–æ–ø—É—Å–∫–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç –∫—É–¥–∞ –æ–Ω–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ —ç—Ç–æ –Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –±—É–¥—É—â–∏–π –∞–Ω–∞–ª–∏–∑) —É–¥–∞–ª–∏—Ç—å –∏—Ö –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞;
    - —Å–æ–∑–¥–∞—Ç—å —Å—Ç–æ–ª–±–µ—Ü `street` —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ —É–ª–∏—Ü –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ —Å `address`;
    - —Å—Ç–æ–ª–±–µ—Ü `is_24/7` —Å –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ–º, —á—Ç–æ –∑–∞–≤–µ–¥–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –∏ –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ (24/7).

## –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
<a id='Data_preprocassing'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ –∑–∞–≤–µ–¥–µ–Ω–∏—è–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—Å–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∏ –∞–¥—Ä–µ—Å –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ø–æ—Å–ª–µ–¥—É—é—â–µ–º –Ω–∞ –Ω–µ—è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã.
"""

# –ø—Ä–∏–≤–µ–¥–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ 'name' –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
catering['name'] = catering['name'].str.lower()

# –ø—Ä–∏–≤–µ–¥–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ 'address'  –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
catering['address'] = catering['address'].str.lower()

"""### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ—è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
<a id='Validation_new_dublicates'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)
"""

# –ø—Ä–æ–≤–µ—Ä–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º 'name' –∏ 'address'
print('–ö–æ–ª-–≤–æ –Ω–µ—è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏ –∞–¥—Ä–µ—Å—É: ', catering.duplicated(subset = ['name', 'address']).sum())

"""–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –º–∞–ª–æ, –ø–æ—ç—Ç–æ–º—É –∏—Ö –º–æ–∂–Ω–æ —Å–º–µ–ª–æ —É–¥–∞–ª–∏—Ç—å –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞."""

# —É–¥–∞–ª–∏–º –Ω–µ—è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º 'name' –∏ 'address'
catering = catering.drop_duplicates(subset = ['name', 'address'])

# –≤—ã–ø–æ–ª–Ω–∏–º –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ –Ω–µ—è–Ω—ã–º –¥—É–±–ª–∏–∫–∞—Ç–∞–º
print('–ö–æ–ª-–≤–æ –Ω–µ—è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏ –∞–¥—Ä–µ—Å—É: ', catering.duplicated(subset = ['name', 'address']).sum())

"""–ù–µ—è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º `name` –∏ `address` —É–¥–∞–ª–µ–Ω—ã, –≤—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–ª–µ–µ."""

# –ø—Ä–æ–≤–µ—Ä–∏–º –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–π–æ–Ω–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –∑–∞–≤–µ–¥–µ–Ω–∏—è
catering['district'].unique()

"""–í—Å–µ –æ–∫—Ä—É–≥–∞ –ú–æ—Å–∫–≤—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –¥—É–±–ª–∏–∫–∞—Ç—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç."""

# –ø—Ä–æ–≤–µ—Ä–∏–º –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –∫–∞—Ç–µ–≥–æ—Ä–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π
catering['category'].unique()

"""–ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Ç–∞–∫–∂–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã, –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤.

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤
<a id='Processing_of_omissions'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

–ö–∞–∫ —Ä–∞–Ω–µ–µ –±—ã–ª–æ –∑–∞–º–µ—á–µ–Ω–æ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–æ–ø—É—Å–∫–∏ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –∫–æ–ª–Ω–∫–∞—Ö:
- `hours`;
- `price`;
- `avg_bill`;
- `middle_avg_bill`;
- `middle_coffee_cup`;
- `seats`.

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—Å–ª–µ–¥–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –∏ —Ä–µ—à–∏—Ç—å, —á—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
"""

# –≤—ã–≤–µ–¥–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –ø–æ –≤—Å–µ–º –∫–æ–ª–æ–Ω–∫–∞–º –¥–∞—Ç–∞—Å–µ—Ç–∞
catering.isna().sum()

"""–ù–∞–∏–±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö `middle_avg_bill` –∏ `middle_coffe_cup`, –¥–∞–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∫–æ–ª–æ–Ω–∫–∏ `avg_bill`, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ç–∞–∫–∂–µ –∏–º–µ–µ—Ç—Å—è –±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤.

- `avg_bill` - –ø—Ä–µ–¥–ª–∞–≥–∞—é –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ –∑–Ω–∞—á–µ–Ω–∏–µ–º '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
- `middle_avg_bill` –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ `avg_bill`, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–æ —Å–ª–æ–≤ "–°—Ä–µ–¥–Ω–∏–π —Å—á—ë—Ç" - –ø—Ä–æ–≤–µ—Ä–∏–º —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–æ–∫ –ø–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º,  –µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–≤–Ω–æ, —Ç–æ –ø—Ä–æ–ø—É—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ–º 0.;
- `middle_coffee_cup` –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ `avg_bill`, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–æ —Å–ª–æ–≤ "–¶–µ–Ω–∞ —á–∞—à–∫–∏ –∫–∞–ø—É—á–∏–Ω–æ" - –ø—Ä–æ–≤–µ—Ä–∏–º —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–æ–∫ –ø–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º, –µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–≤–Ω–æ, —Ç–æ –ø—Ä–æ–ø—É—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ–º 0.
"""

print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –æ—Å—Ç–∞–ª–æ—Å—å:', catering['middle_avg_bill'].isna().sum())

import warnings
warnings.filterwarnings("ignore")

# –∑–∞–ø–æ–ª–Ω–∏–º –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –∫–æ–ª–æ–Ω–∫–µ 'avg_bill'
catering['avg_bill'] = catering['avg_bill'].fillna('–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö')

# –ø—Ä–æ–≤–µ—Ä–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –ø–æ –∫–æ–ª–æ–Ω–∫–µ 'avg_bill' —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º "–°—Ä–µ–¥–Ω–∏–π —Å—á—ë—Ç" –∏ –∫–æ–ª-–≤–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –ø–æ –∫–æ–ª–æ–Ω–∫–µ 'middle_avg_bill'
print('–ö–æ–ª-–≤–æ —Å—Ç—Ä–æ–∫ —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º "–°—Ä–µ–¥–Ω–∏–π —Å—á—ë—Ç": ', len(catering.loc[catering['avg_bill'].apply(lambda x: x.find('–°—Ä–µ–¥–Ω–∏–π —Å—á—ë—Ç')) != -1]))
print('–ö–æ–ª-–≤–æ —Å—Ç—Ä–æ–∫ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º —Å—Ä–µ–¥–Ω–∏–º —Å—á—ë—Ç–æ–º: ', len(catering.query('~middle_avg_bill.isna()')))

"""–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö —Ä–∞–≤–Ω–æ, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ–ø—É—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ–º 0."""

# –ø—Ä–æ–≤–µ—Ä–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –ø–æ –∫–æ–ª–æ–Ω–∫–µ 'avg_bill' —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º "–¶–µ–Ω–∞ —á–∞—à–∫–∏ –∫–∞–ø—É—á–∏–Ω–æ" –∏ –∫–æ–ª-–≤–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –ø–æ –∫–æ–ª–æ–Ω–∫–µ 'middle_coffee_cup'
print('–ö–æ–ª-–≤–æ —Å—Ç—Ä–æ–∫ —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º "–¶–µ–Ω–∞ –æ–¥–Ω–æ–π —á–∞—à–∫–∏ –∫–∞–ø—É—á–∏–Ω–æ": ', len(catering.loc[catering['avg_bill'].apply(lambda x: x.find('–¶–µ–Ω–∞ —á–∞—à–∫–∏ –∫–∞–ø—É—á–∏–Ω–æ')) != -1]))
print('–ö–æ–ª-–≤–æ —Å—Ç—Ä–æ–∫ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º —Å—Ä–µ–¥–Ω–∏–º —Å—á—ë—Ç–æ–º: ', len(catering.query('~middle_coffee_cup.isna()')))

"""–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö —Ä–∞–≤–Ω–æ, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ–ø—É—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ–º 0.

–ü–µ—Ä–µ–π–¥–µ–º –∫ –∫–æ–ª–æ–Ω–∫–∞–º `hours` –∏ `price`. –í –¥–∞–Ω–Ω—ã—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö —Ç–∞–∫–∂–µ –ø—Ä–∏—Å—É—Ç—Å–≤—É—é—Ç –ø—Ä–æ–ø—É—Å–∫–∏, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—Å—É–ª–æ–≤–ª–µ–Ω–æ —Ç–µ–º, —á—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞ –∑–∞–≤–µ–¥–µ–Ω–∏—è, –∑–∞–≤–µ–¥–µ–Ω–∏–µ –Ω–∏–≥–¥–µ –Ω–µ —É–∫–∞–∑—ã–≤–∞–ª–æ —á–∞—Å—ã —Å–≤–æ–µ–π —Ä–∞–±–æ—Ç—ã –∏ —Ç.–ø. –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –ø—Ä–æ–ø—É—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ–º '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'.
"""

# –∑–∞–ø–æ–ª–Ω–∏–º –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–ª–æ–Ω–∫–µ 'hours'  –∑–Ω–∞—á–µ–Ω–∏–µ–º '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'
catering['hours'] = catering['hours'].fillna('–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö')

# –∑–∞–ø–æ–ª–Ω–∏–º –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–ª–æ–Ω–∫–µ 'price' –∑–Ω–∞—á–µ–Ω–∏–µ–º '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'
catering['price'] = catering['price'].fillna('–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö')

"""–ü–µ—Ä–µ–π–¥–µ–º –∫ –∫–æ–ª–æ–Ω–∫–µ `seats`, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ç–∞–∫–∂–µ –∏–º–µ—é—Ç—Å—è –ø—Ä–æ–ø—É—Å–∫–∏. –û–ø—è—Ç—å –∂–µ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–¥—Å—á–µ—Ç–∞—Ö –º–æ–≥–ª–∏ –Ω–µ –≤–Ω–æ—Å–∏—Ç—Å—è –ª–∏–±–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç —Å–ª–æ–∂–Ω–æ –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å. –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–µ–¥–ª–∞–≥–∞—é –≤—Å–µ –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ–º -1."""

# –∑–∞–ø–æ–ª–Ω–∏–º –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–ª–æ–Ω–∫–µ 'seats' –∑–Ω–∞—á–µ–Ω–∏–µ–º '-1'
catering['seats'] = catering['seats'].fillna(-1)

# –ø—Ä–æ–≤–µ—Ä–∏–º –Ω–∞–ª–∏—á–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –ø–æ—Å–ª–µ –ø—Ä–µ–æ–±—Ä–∞–±–æ—Ç–∫–∏
catering.isna().sum()

catering = catering.reset_index()

"""–ü—Ä–æ–ø—É—Å–∫–∏ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã, –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø–æ—Å–ª–µ–¥—É—é—â—É—é –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É.

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
<a id='Changing_data_types'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

–¢–∞–∫–∂–µ –ø—Ä–µ–¥–ª–∞–≥–∞—é –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫–æ–ª–æ–Ω–∫–∏ —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞, —Ü–µ–Ω–æ–π –∑–∞ —á–∞—à–∫—É –∫–æ—Ñ–µ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –∫ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–º—É —Ç–∏–ø—É –¥–∞–Ω–Ω—ã—Ö.
"""

# –ø—Ä–∏–≤–µ–¥–µ–º –∫–æ–ª–æ–Ω–∫—É 'seats' –∫ —Ü–µ–ª–æ–º—É —á–∏—Å–ª—É
catering['seats'] = catering['seats'].astype('int')

# –≤—ã–≤–µ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –¥–∞—Ç–∞—Å–µ—Ç—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
catering.info()

"""### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ –≤ –¥–∞—Ç–∞—Å–µ—Ç
<a id='Adding_columns_to_dataset'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)
"""

# —Å–æ–∑–¥–∞–¥–∏–º –∫–æ–ª–æ–Ω–∫—É 'street' —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É–ª–∏—Ü –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ 'address'
catering['street'] = catering['address'].str.split(', ').str[1]

# —Å–æ–∑–¥–∞–¥–∏–º –∫–æ–ª–æ–Ω–∫—É 'is_24/7' —Å –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ–º —Ä–∞–±–æ—Ç—ã –∑–∞–≤–µ–¥–µ–Ω–∏—è –ø–æ –∫–æ–ª–æ–Ω–∫–µ 'hours'
# –µ—Å–ª–∏ –∫–æ–ª–æ–Ω–∫–∞ 'hours' –∏–º–µ–µ—Ç –∑–∞–Ω—á–µ–Ω–∏–µ "–µ–∂–µ–¥–Ω–µ–≤–Ω–æ, –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ", —Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ 'is_24/7'  - True
# –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ False

catering['is_24/7'] = catering['hours'].str.contains('–µ–∂–µ–¥–Ω–µ–≤–Ω–æ, –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ')

# –≤—ã–≤–µ–¥–∏–º —Ç–∞–±–ª–∏—Ü—É –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
catering

"""<b>–ò—Ç–æ–≥:</b>

–ù–∞–º–∏ –±—ã–ª –ø—Ä–æ—Ä–∞–±–æ—Ç–∞–Ω –¥–∞—Ç–∞—Å–µ—Ç —Å –ø–æ–ª—É—á–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
- —É–¥–∞–ª–∏–ª–∏ –Ω–µ—è–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º `name` –∏ `address` –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ 4 —à—Ç—É–∫;
- –ø–æ–º–µ–Ω—è–ª–∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö `middle_avg_bill`, `middle_coffee_cup`, `seats`;
- –∑–∞–ø–æ–ª–Ω–∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö `middle_avg_bill`, `middle_coffee_cup`, `seats`, `avg_bill`, `hours`, `price`;
- –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö `name` –∏ `address` –∑–Ω–∞—á–µ–Ω–∏—è –±—ã–ª–∏ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É;
- –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–ª–æ–Ω–∫–∏ `street` –∏ `is_24/7`.

## –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
<a id='Data_Analysis'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π
<a id='Categories'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b>–ó–ê–î–ê–ß–ê.</b> –ö–∞–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –¥–∞–Ω–Ω—ã—Ö? –ò—Å—Å–ª–µ–¥—É–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º: —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã, –∫–æ—Ñ–µ–π–Ω–∏, –ø–∏—Ü—Ü–µ—Ä–∏–∏, –±–∞—Ä—ã –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ. –ü–æ—Å—Ç—Ä–æ–∏–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∏ –æ—Ç–≤–µ—Ç–∏–º –Ω–∞ –≤–æ–ø—Ä–æ—Å –æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
"""

#–∏–∑—É—á–∏–º –∫–∞–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∏ –∫–∞–∫–æ–µ –∫–æ–ª-–≤–æ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
place_cetagories = catering.pivot_table(index = 'category', values = 'name', aggfunc = 'count')
place_cetagories = place_cetagories.rename(columns={'name': 'count'})
place_cetagories = place_cetagories.reset_index()
place_cetagories = place_cetagories.sort_values(by='count', ascending=False)
place_cetagories

#c—á–∏—Ç–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π
total_count = place_cetagories['count'].sum()

#–≤—ã—á–∏—Å–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
percentages = [f'{count/total_count*100:.2f}%' for count in place_cetagories['count']]

fig_bar = go.Figure(data=[go.Bar(x=place_cetagories['category'],
                                y=place_cetagories['count'],
                                marker_color=px.colors.qualitative.Pastel,
                                text=percentages)])

fig_bar.update_layout(title='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –≤ –ú–æ—Å–∫–≤–µ',
                      xaxis_title='–ö–∞—Ç–µ–≥–æ—Ä–∏–∏',
                      yaxis_title='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ',
                      title_x=0.5)
fig_bar.show();

"""<div class="alert alert-block alert-danger">‚úç
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–ü—Ä–∏ —Ç–∞–∫–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–∞–Ω–Ω—ã–π –≤–∏–¥ –≥—Ä–∞—Ñ–∏–∫–∞ –±—É–¥–µ—Ç —Å–ª–æ–∂–Ω—ã–º –∫ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—é (–∫—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–∞ –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –µ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω—ã –¥–æ–ª–∏, –ø–æ–¥–ø–∏—Å–∞–Ω—ã –∑–Ω–∞—á–µ–Ω–∏—è, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ —Å—Ç–∞–≤–∏—Ç—Å—è –≤–æ–ø—Ä–æ—Å –∑–∞—á–µ–º –Ω—É–∂–Ω–∞ –∫—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—Å—ë –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å). –ü–æ–ø—Ä–∞–≤—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –≤–æ –≤—Å–µ–º –ø—Ä–æ–µ–∫—Ç–µ. –ß—Ç–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–∞ —ç—Ç–æ–º –Ω–µ –∞–∫—Ü–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ
</div>

<div class="alert alert-info"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ò—Å–ø—Ä–∞–≤–∏–ª –Ω–∞ —Å—Ç–æ–ª–±—á–∞—Ç—É—é –¥–∏–∞–≥—Ä–∞–º–º—É, –Ω–∞–¥–µ—é—Å—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä —Å–¥–µ–ª–∞–ª =) –¥–∞–ª–µ–µ —É –º–µ–Ω—è –∫—Ä—É–≥–æ–≤—ã—Ö –¥–∏–∞–≥—Ä–∞–º–º –±–æ–ª–µ–µ –Ω–µ—Ç, –∫—Ä–æ–º–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π. –¢–∞–º –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è –æ–Ω–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç –±–æ–ª—å—à–µ.
    
–ü–æ –æ—Å—Ç–∞–ª—å–Ω—ã–º –≤—Ä–æ–¥–µ –≤—Å–µ —á–∏—Ç–∞–±–µ–ª—å–Ω–æ –∏–ª–∏ –Ω–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—á–∏—Ç–∞—é?

<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ2__

–î–∞–≤–∞–π –ø–æ—Å–º–æ—Ç—Ä–∏–º)
    
    
–û—Ç–ª–∏—á–Ω—ã–π –∏ –Ω–∞–≥–ª—è–¥–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ üëç
    
–ó–¥–æ—Ä–æ–≤–æ, –∫–æ–≥–¥–∞ –æ–Ω –ø–æ–¥–ø–∏—Å–∞–Ω. –¢–∞–∫ –±—ã—Å—Ç—Ä–µ–µ –ø–æ–Ω—è—Ç—å –æ —á–µ–º –∏–¥—ë—Ç —Ä–µ—á—å –Ω–∞ –Ω—ë–º.
    
</div>

<b>–ò—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º—ã –Ω–∞–±–ª—é–¥–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é –∫–∞—Ä—Ç–∏–Ω—É:
- –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤ –ú–æ—Å–∫–≤–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∫–∞—Ñ–µ - `28,3 %`;
- —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã –∑–∞–Ω–∏–º–∞—é—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ–µ –≤—Ç–æ—Ä–æ–µ –º–µ—Å—Ç–æ - `24,3 %`;
- –∫–æ—Ñ–µ–π–Ω–∏ –∑–∞–Ω–∏–º–∞—é—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ–µ —Ç—Ä–µ—Ç—å–µ –º–µ—Å—Ç–æ - `16,8 %`;
- –ø—Ä–∏–º–µ—Ä–Ω–æ `25 %` –æ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç "–±–∞—Ä, –ø–∞–±" - `9,09 %`, "–ø–∏—Ü—Ü–µ—Ä–∏—è–º" - `7,53 %`, "–±—ã—Å—Ç—Ä–æ–µ –ø–∏—Ç–∞–Ω–∏–µ" - `7,18 %`;
- —Å–∞–º–æ–µ –º–µ–Ω—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º: "—Å—Ç–æ–ª–æ–≤–∞—è" - `3,75 %` –∏ "–±—É–ª–æ—á–Ω–∞—è" - `3,05 %`.

### –ö–æ–ª-–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∑–∞–≤–µ–¥–µ–Ω–∏–π
<a id='Number_of_seats'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b>–ó–ê–î–ê–ß–ê.</b> –ò—Å—Å–ª–µ–¥—É–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –≤ –º–µ—Å—Ç–∞—Ö –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º: —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã, –∫–æ—Ñ–µ–π–Ω–∏, –ø–∏—Ü—Ü–µ—Ä–∏–∏, –±–∞—Ä—ã –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ. –ü–æ—Å—Ç—Ä–æ–∏–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏, –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ —Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º –≤—ã–≤–æ–¥—ã.
"""

#—Å–æ–∑–¥–∞–¥–∏–º –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç, —É–±—Ä–∞–≤ –∑–∞–≤–µ–¥–µ–Ω–∏—è –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –∫–æ–ª-–≤–∞ —Å–∏–¥—è—á–∏—Ö –º–µ—Å—Ç
seats_analysis = catering.query('seats != -1')

#—Å–≥—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞—Ç–∞—Å–µ—Ç –∏ –ø–æ—Å—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª-–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
place_seats = seats_analysis.groupby('category') \
                                             .agg(median=('seats', 'median')) \
                                             .sort_values(by='median', ascending=False) \
                                             .reset_index()

#–∏–∑–º–µ–Ω–∏–º —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –∫–æ–ª–æ–Ω–∫–∏ —Å–æ —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –Ω–∞ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω–æ–µ
place_seats['median'] = place_seats['median'].astype('int')

#–≤—ã–≤–µ–¥–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
place_seats

#–ø–æ—Å—Ç—Ä–æ–∏–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ
fig_bar = px.bar(place_seats,
             x='median',
             y='category',
             text='median')

fig_bar.update_layout(title='–°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª-–≤–æ –º–µ—Å—Ç –≤ –∑–∞–≤–µ–¥–µ–Ω–∏—è—Ö',
                                   title_x = 0.5,
                                   xaxis_title='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç',
                                   yaxis_title='–ö–∞—Ç–µ–≥–æ—Ä–∏—è')

fig_bar.show();

"""<b>–ò—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º—ã –Ω–∞–±–ª—é–¥–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é –∫–∞—Ä—Ç–∏–Ω—É:
- —Ç—Ä–æ–π–∫—É –ª–∏–¥–µ—Ä–æ–≤ –ø–æ –º–µ–¥–∏–∞–Ω–Ω–æ–º—É —á–∏—Å–ª—É –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç —É–¥–µ—Ä–∂–∏–≤–∞—é—Ç:
    - `—Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã` - 86 –º–µ—Å—Ç;
    - `–±–∞—Ä—ã, –ø–∞–±—ã` - 82 –º–µ—Å—Ç–∞;
    - `–∫–æ—Ñ–µ–π–Ω–∏` - 80 –º–µ—Å—Ç.
- –¥–∞–ª–µ–µ –∏–¥—É—Ç –∑–∞–≤–µ–¥–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `—Å—Ç–æ–ª–æ–≤–∞—è` - 75 –º–µ—Å—Ç;
- —Ç–∞–∫ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –æ–±—ã—á–Ω–æ —è–≤–ª—è—é—Ç—Å—è —Å–µ—Ç–µ–≤—ã–º–∏ –∏ –∏—Ö –º–Ω–æ–≥–æ –ø–æ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏, —Ç–æ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º —á–∏—Å–ª–æ–≤–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ:
    - `–±—ã—Å—Ç—Ä–æ–µ –ø–∏—Ç–∞–Ω–∏–µ` - 65 –º–µ—Å—Ç;
    - `–∫–∞—Ñ–µ` - 60 –º–µ—Å—Ç;
    - `–ø–∏—Ü—Ü–µ—Ä–∏—è` - 55 –º–µ—Å—Ç–∞.
- –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º –º–µ—Å—Ç–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∑–∞–≤–µ–¥–µ–Ω–∏—è —Ç–∏–ø–∞ `–±—É–ª–æ—á–Ω–∞—è` - 50 –º–µ—Å—Ç, –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –±—É–ª–æ—á–Ω—ã–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –≤—ã–Ω–æ—Å.

<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–î–∞, –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç —É —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤, –∞ –º–µ–Ω—å—à–µ —É –±—É–ª–æ—á–Ω—ã—Ö. –ß—Ç–æ –≤–ø–æ–ª–Ω–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ
</div>

### –ò–∑—É—á–µ–Ω–∏–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π
<a id='Network_network'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b></b>

<b>–ó–ê–î–ê–ß–ê.</b> –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∏ –∏–∑–æ–±—Ä–∞–∑–∏–º —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ. –û—Ç–≤–µ—Ç–∏–º –Ω–∞ –≤–æ–ø—Ä–æ—Å - –∫–∞–∫–∏—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –±–æ–ª—å—à–µ?
"""

#—Å–≥—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞—Ç–∞—Å–µ—Ç –ø–æ —Å–µ—Ç–µ–≤—ã–º –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã–º –∑–∞–≤–µ–¥–µ–Ω–∏—è–º
type_chain = catering['chain'].value_counts().reset_index()
type_chain.columns = ['chain', 'count']

#–≤—ã–≤–µ–¥–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç
type_chain

#–≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã–µ –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π
fig_type_chain = go.Figure(data = [go.Pie(labels = ['–ù–µ—Å–µ—Ç–µ–≤—ã–µ', '–°–µ—Ç–µ–≤—ã–µ'],
                                            values = type_chain['count'],
                                            pull = [0.1, 0],
                                            hole=0.5)])

fig_type_chain.update_layout(title='–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –ú–æ—Å–∫–≤—ã',
                                               title_x = 0.5,
                                               annotations=[dict(text='–¢–∏–ø', x=1.12, y=1.05, showarrow=False)])
fig_type_chain.show();

"""<b>–ü–æ–¥–∏—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ –º—ã –≤–∏–¥–∏–º, —á—Ç–æ `61,9 %` —è–≤–ª—è—é—Ç—Å—è `–ù–µ—Å–µ—Ç–µ–≤—ã–µ` –∑–∞–≤–µ–¥–µ–Ω–∏—è –ú–æ—Å–∫–≤—ã, –∞ `38,1 %` —è–≤–ª—è—é—Ç—Å—è `–°–µ—Ç–µ–≤—ã–µ` –∑–∞–≤–µ–¥–µ–Ω–∏—è.
–ü—Ä–µ–¥–ª–∞–≥–∞—é –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∑–∞–≤–µ–¥–µ–Ω–∏–π —Å–µ—Ç–µ–≤—ã—Ö –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö.

<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–ù–µ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π, –∫–∞–∫ –∏ –æ–∂–∏–¥–∞–ª–æ—Å—å –±–æ–ª—å—à–µ
</div>
"""

#—Å–æ–∑–¥–∞–¥–∏–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ —Ç–∏–ø—É –∑–∞–≤–µ–¥–µ–Ω–∏–π
place_chain = catering.pivot_table(index = ['category', 'chain'], values = 'name', aggfunc = 'count')
place_chain = place_chain.rename(columns={'name': 'count'})
place_chain = place_chain.reset_index()
place_chain = place_chain.sort_values(by=['count', 'chain'], ascending=False)
place_chain

fig_chain_cat = px.bar(place_chain,
                                     x='count',
                                     y='category',
                                     text= 'count',
                                     color='chain',
                                     category_orders={"chain":['–°–µ—Ç–µ–≤–æ–µ', '–ù–µ—Å–µ—Ç–µ–≤–æ–µ']},
                                     color_discrete_sequence=["#FFA15A", "#9467DB"],
                                     height=500,
                                     width=900)

fig_chain_cat.update_layout(title = '–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π',
                                             title_x = 0.55,
                                             xaxis_title = '–ö–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π',
                                             yaxis_title = '–ö–∞—Ç–µ–≥–æ—Ä–∏–∏')

fig_chain_cat.show()

"""<b>–ò—Ç–æ–≥:</b>

–ü–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–º—É –∞–Ω–∞–ª–∏–∑—É –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–≤–æ–¥—ã:
- `61,9 %` —è–≤–ª—è—é—Ç—Å—è `–ù–µ—Å–µ—Ç–µ–≤—ã–µ` –∑–∞–≤–µ–¥–µ–Ω–∏—è –ú–æ—Å–∫–≤—ã;
- `38,1 %` —è–≤–ª—è—é—Ç—Å—è `–°–µ—Ç–µ–≤—ã–µ` –∑–∞–≤–µ–¥–µ–Ω–∏—è;
- –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ, —á—Ç–æ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –±–æ–ª—å—à–µ, –∫—Ä–æ–º–µ:
    - `–ö–æ—Ñ–µ–π–Ω—å` - –°–µ—Ç–µ–≤—ã–µ `720` –∏ –ù–µ—Å–µ—Ç–µ–≤—ã–µ `693`;
    - `–ü–∏—Ü—Ü–µ—Ä–∏–π` - –°–µ—Ç–µ–≤—ã–µ `330` –∏ –ù–µ—Å–µ—Ç–µ–≤—ã–µ `302`;
    - `–ë—É–ª–æ—á–Ω—ã—Ö` - –°–µ—Ç–µ–≤—ã–µ `157` –∏ –ù–µ—Å–µ—Ç–µ–≤—ã–µ `99`.

<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–í–µ—Ä–Ω–æ, –±—É–ª–æ—á–Ω–∞—è –∏ –ø–∏—Ü—Ü–µ—Ä–∏—è –≤ –¢–û–ü –ø–æ –∫–æ–ª-–≤—É —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π
</div>

### –¢–æ–ø –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å–µ—Ç–µ–π –≤ –ú–æ—Å–∫–≤–µ
<a id='Top_network'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b>–ó–ê–î–ê–ß–ê.</b> –°–≥—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º –∑–∞–≤–µ–¥–µ–Ω–∏–π –∏ –Ω–∞–π–¥–∏—Ç–µ —Ç–æ–ø-15 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å–µ—Ç–µ–π –≤ –ú–æ—Å–∫–≤–µ. –ü–æ–¥ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å—é –ø–æ–Ω–∏–º–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π —ç—Ç–æ–π —Å–µ—Ç–∏ –≤ —Ä–µ–≥–∏–æ–Ω–µ. –ü–æ—Å—Ç—Ä–æ–∏–º –ø–æ–¥—Ö–æ–¥—è—â—É—é –¥–ª—è —Ç–∞–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é. –û—Ç–≤–µ—Ç–∏–º –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã:
- –ó–Ω–∞–∫–æ–º—ã –ª–∏ –Ω–∞–º —ç—Ç–∏ —Å–µ—Ç–∏?
- –ï—Å—Ç—å –ª–∏ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏–∑–Ω–∞–∫, –∫–æ—Ç–æ—Ä—ã–π –∏—Ö –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç?
- –ö –∫–∞–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π –æ–Ω–∏ –æ—Ç–Ω–æ—Å—è—Ç—Å—è?
"""

#—Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º –¥–∞—Ç–∞—Å–µ—Ç —Ç–æ–ª—å–∫–æ —Å —Å–µ—Ç–µ–≤—ã–º–∏ –∑–∞–≤–µ–¥–µ–Ω–∏—è–º–∏
chain_data = catering.query('chain == 1')

top_15_chain = chain_data.groupby('name').agg({'rating' : 'median', 'category' : pd.Series.mode, 'district' : 'count'})
top_15_chain = top_15_chain.rename(columns={'district':'count'})
top_15_chain = top_15_chain.sort_values('count', ascending = False).reset_index().head(15)

top_15_chain

#—Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º —Å—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¢–æ–ø-15
#top_15 = top_15_chain.loc[0:14].sort_values(by='count', ascending=True)
my_range=range(1,len(top_15_chain.index)+1)

#–ø–æ—Å—Ç—Ä–æ–∏–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫
plt.hlines(y=my_range, xmin=0, xmax=top_15_chain['count'], color='skyblue')
plt.plot(top_15_chain['count'], my_range, "x")

#–æ—Ç—Ñ–æ—Ä–º–∞—Ç—Ä–∏—É–µ–º –≥—Ä–∞—Ñ–∏–∫
plt.yticks(my_range, top_15_chain['name'])
plt.title("–¢–æ–ø-15 —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π", loc='center')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π')
plt.ylabel('–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏–π')

# –≤—ã–≤–µ–¥–∏–º –≥—Ä–∞—Ñ–∏–∫
plt.show()

"""<b>–ü–æ–¥–∏—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏ –≥—Ä–∞—Ñ–∏–∫—É –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–∫–ª—é—á–µ–Ω–∏—è:
- —Å–∞–º—ã–º –ø–æ–ø—É–ª—è—Ä–Ω—ã–º —Å–µ—Ç–µ–≤—ã–º –∑–∞–≤–µ–¥–µ–Ω–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è `–®–æ–∫–æ–ª–∞–¥–Ω–∏—Ü–∞` - 120 –∑–∞–≤–µ–¥–µ–Ω–∏–π;
- –≤—Ç–æ—Ä–æ–µ –∏ —Ç—Ä–µ—Ç—å–µ –º–µ—Å—Ç–æ –∑–∞ `–î–æ–º–∏–Ω–æ'c –ø–∏—Ü—Ü–∞` –∏ `–î–æ–¥–æ –ø–∏—Ü—Ü–∞` - 76 –∏ 74 –∑–∞–≤–µ–¥–µ–Ω–∏–π.

<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–ó–¥–æ—Ä–æ–æ–≤–æ, —á—Ç–æ –Ω–µ –∑–∞–±—ã–ª –ø—Ä–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ chain
</div>
"""

fig = px.bar(top_15_chain,
                    x='count',
                    y='category',
                    color='category',
                    text = 'name')

fig.update_layout(title='–¢–æ–ø-15. –ö–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º',
                            title_x = 0.5,
                            xaxis_title='–ö–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π',
                            yaxis_title='–ö–∞—Ç–µ–≥–æ—Ä–∏—è',
                            yaxis={'categoryorder':'total ascending'}
                 )
fig.show()

"""<b>–ü–æ–¥–∏—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫—É –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–∫–ª—é—á–µ–Ω–∏—è, —á—Ç–æ –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –≤ –¢–æ–ø-15 - —ç—Ç–æ `–∫–æ—Ñ–µ–π–Ω–∏`, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–æ —Ç–µ–º, —á—Ç–æ —Å–µ—Ç–µ–≤—ã–µ –º–∞–ª–µ–Ω—å–∫–∏–µ –∫–æ—Ñ–µ–π–Ω–∏ –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—â–µ –∏ –±—ã—Å—Ç—Ä–µ–µ.

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ `–î–æ–º–∏–Ω–æ—Å` –∏ `–î–æ–¥–æ –ø–∏—Ü—Ü–∞` –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å –Ω–∞ 2 –∏ 3 —Å—Ç—Ä–æ—á–∫–µ –¢–æ–ø-15 —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π, –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–≤–µ–¥–µ–Ω–∏–π –¥–∞–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –∞ –∏–º–µ–Ω–Ω–æ `–ø–∏—Ü—Ü–µ—Ä–∏—è` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Ç—Ä–µ—Ç—å–µ–º –º–µ—Å—Ç–µ –∏ –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `–∫–æ—Ñ–µ–π–Ω–∏` –æ—Ç—Å—Ç–∞–µ—Ç –ø–æ—á—Ç–∏ –≤ 2-–µ —Ä–∞–∑.

–ó–∞–º—ã–∫–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—è `–±—É–ª–æ—á–Ω–∞—è`, –∞ –∏–º–µ–Ω–Ω–æ –æ–¥–Ω–æ —Å–µ—Ç–µ–≤–æ–µ –∑–∞–≤–µ–¥–µ–Ω–∏–µ –≤ –¢–æ–ø-15 `–ë—É—Ö–∞–Ω–∫–∞`, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è —Å–µ—Ç–∫–æ–π, –æ–∫—Ç—Ä—ã–≤–∞—é—â–µ–π—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –≤ –Ω–æ–≤—ã—Ö –ñ–ö –ú–æ—Å–∫–≤–∞, –¥–∞–Ω–Ω–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–µ–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π.

–î–∞–≤–∞–π—Ç–µ –∏–∑—É—á–∏–º –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–Ω—ã –ø–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º —Ä–∞–π–æ–Ω–∞–º.

<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–í–µ—Ä–Ω–æ, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å–µ—Ç–µ–π —ç—Ç–æ –∫–æ—Ñ–µ–π–Ω–∏
</div>
"""

#—Å–≥—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞—Ç–∞—Å–µ—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ —Ä–∞–π–æ–Ω–∞–º –ú–æ—Å–∫–≤—ã
catering_district = chain_data.groupby(['district', 'category', 'name']).agg({'rating' : 'median', 'address' : 'count'})
catering_district = catering_district.sort_values('rating', ascending = False).reset_index()
catering_district = catering_district.rename(columns={'address':'count'})
catering_district = catering_district[catering_district['name'].isin(top_15_chain['name'])]

catering_district = catering_district.reset_index()

#–≤—ã–≤–µ–¥–∏–º head –∏ tail –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
catering_district

"""–î–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —á–∏—Ç–∞–±–µ–ª—å–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–µ–¥–ª–∞–≥–∞—é –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ –¥–æ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä."""

def name_district(df):
    for i in range(len(df)):
        if df['district'][i] == "–°–µ–≤–µ—Ä–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥":
            df.at[i, 'district'] = "C–ê–û"
        elif df['district'][i] == "–°–µ–≤–µ—Ä–æ-–í–æ—Å—Ç–æ—á–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥":
            df.at[i, 'district'] = "C–í–ê–û"
        elif df['district'][i] == "–°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥":
            df.at[i, 'district'] = "C–ó–ê–û"
        elif df['district'][i] == "–ó–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥":
            df.at[i, 'district'] = "–ó–ê–û"
        elif df['district'][i] == "–í–æ—Å—Ç–æ—á–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥":
            df.at[i, 'district'] = "–í–ê–û"
        elif df['district'][i] == "–Æ–≥–æ-–í–æ—Å—Ç–æ—á–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥":
            df.at[i, 'district'] = "–Æ–í–ê–û"
        elif df['district'][i] == "–Æ–∂–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥":
            df.at[i, 'district'] = "–Æ–ê–û"
        elif df['district'][i] == "–Æ–≥–æ-–ó–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥":
            df.at[i, 'district'] = "–Æ–ó–ê–û"
        else:
            df.at[i, 'district'] = "–¶–ê–û"
    return df

catering_district = name_district(catering_district)

#–ø—Ä–æ–≤–µ—Ä–∏–º –∑–∞–º–µ–Ω—É
catering_district

fig_catering_district = px.bar(catering_district,
                                               x='count',
                                               y='district',
                                               color='category')

fig_catering_district.update_layout(title='–ö–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –≤ —Ä–∞–π–æ–Ω–∞—Ö –ú–æ—Å–∫–≤—ã',
                                                       title_x = 0.5,
                                                       xaxis_title='–ö–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π',
                                                       yaxis_title='–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞–π–æ–Ω',
                                                       yaxis={'categoryorder':'total ascending'})

fig_catering_district.show()

"""<b>–ò—Ç–æ–≥:</b>

–ü–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–º—É –∞–Ω–∞–ª–∏–∑—É –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–µ–º —Å–ª—É–¥—é—â–∏–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è:
- —Å–∞–º–∞—è –ø–æ–ø—É–ª—è—Ä–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∏–∑ –¢–æ–ø 15 —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π - `–∫–æ—Ñ–µ–π–Ω–∏`;
- —Å—Ä–µ–¥–∏ –∫–æ—Ñ–µ–π–Ω—å —Å–∞–º–æ–π –ø–æ–ø—É–ª—è—Ä–Ω–æ–π —Å–µ—Ç–∫–æ–π —è–≤–ª—è–µ—Ç—Å—è `–©–æ–∫–æ–ª–∞–¥–Ω–∏—Ü–∞` - –¥–∞–Ω–Ω–∞—è –∫–æ—Ñ–µ–π–Ω—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –¥–∞–≤–Ω–æ –Ω–∞ —Ä—ã–Ω–∫–µ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è, –¥–∞–ª–µ–µ –∏–¥—É—Ç –∫–æ—Ñ–µ–π–Ω–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—ã—Å—Ç—Ä–æ –∏ –ª–µ–≥–∫–æ –æ—Ç–∫—Ä—ã—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ —Ñ—Ä–∞–Ω—à–∏–∑–µ);
- –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥` (–¶–ê–û), –ø–æ –≤—Å–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º —Ä–∞–π–æ–Ω–æ–º –º–æ–∂–Ω–æ –Ω–∞–±–ª—é–¥–∞—Ç—å +- —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ;
- —Å–∞–º—ã–π –Ω–µ–ø–æ–ø—É–ª—è—Ä–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞–π–æ–Ω - —ç—Ç–æ `–°–µ–≤–µ—Ä–æ-–∑–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥`, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–π –æ–∫—Ä—É–≥ –Ω–µ –≥–µ—Å—Ç–æ –∑–∞—Å–µ–ª–µ–Ω, –≤ –Ω–µ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –º–Ω–æ–≥–æ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π.

### –ò–∑—É—á–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ –ú–æ—Å–∫–≤—ã
<a id='Districts'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b>–ó–ê–î–ê–ß–ê.</b> –ö–∞–∫–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ä–∞–π–æ–Ω—ã –ú–æ—Å–∫–≤—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ? –û—Ç–æ–±—Ä–∞–∑–∏–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ —Ä–∞–π–æ–Ω–∞–º. –ü–æ–ø—Ä–æ–±—É–µ–º –ø—Ä–æ–∏–ª–ª—é—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–¥–Ω–∏–º –≥—Ä–∞—Ñ–∏–∫–æ–º.

–ö–∞–∫ –º—ã —Ä–∞–Ω–µ–µ –≤—ã—è—Å–Ω–∏–ª–∏ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ 8402 –∑–∞–≤–µ–¥–µ–Ω–∏–π, –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –∫–∞–∫ –æ–Ω–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º —Ä–∞–π–æ–Ω–∞–º –ú–æ—Å–∫–≤—ã.
"""

#–≤—ã–≤–µ–¥–∏–º –∫–∞–∫–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ä–∞–π–æ–Ω—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ
print('–ö–æ–ª-–≤–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ –ú–æ—Å–∫–≤—ã –≤ –¥–∞—Ç–∞—Å–µ—Ç: ', catering['district'].nunique(), '\n')
print('–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤:\n\n', catering['district'].unique())

#—Å–æ–∑–¥–∞–¥–∏–º –¥–∞—Ç–∞—Å–µ—Ç –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º —Ä–∞–π–Ω–∞–º
category_district= catering.groupby(['district', 'category']).agg({'rating' : 'median', 'name' : 'count'})
category_district = category_district.sort_values('rating', ascending = False).reset_index()
category_district = category_district.rename(columns={'name':'count'})

#–≤—ã–≤–µ–¥–∏–º head –∏ tail –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
category_district

#–ø–µ—Ä–µ–≤–µ–¥–µ–º –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ –∫ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–∞–º
category_district = name_district(category_district)

#–ø—Ä–æ–≤–µ—Ä–∏–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
category_district.head()

fig_category_district = px.bar(category_district,
                                                x='count',
                                                y='district',
                                                color='category')

fig_category_district.update_layout(title='–ö–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–≤ –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–∞–π–æ–Ω –ú–æ—Å–∫–≤—ã',
                                                         title_x = 0.5,
                                                         xaxis_title='–ö–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π',
                                                         yaxis_title='–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞–π–æ–Ω',
                                                         yaxis={'categoryorder':'total ascending'})

fig_category_district.show()

"""<b>–ò—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–º—É –∞–Ω–∞–ª–∏–∑—É –∑–∞—Ñ–∏–∫—Å–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è:
- –≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –≤—Å–µ 9 –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ –ú–æ—Å–∫–≤—ã:
    - –°–µ–≤–µ—Ä–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–°–ê–û);
    - –°–µ–≤–µ—Ä–æ-–í–æ—Å—Ç–æ—á–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–°–í–ê–û);
    - –°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–°–ó–ê–û);
    - –ó–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–ó–ê–û);
    - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–¶–ê–û);
    - –í–æ—Å—Ç–æ—á–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–í–ê–û);
    - –Æ–≥–æ-–í–æ—Å—Ç–æ—á–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–Æ–í–ê–û);
    - –Æ–∂–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–Æ–ê–û);
    - –Æ–≥–æ-–ó–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–Æ–ó–ê–û).
- –º—ã –Ω–∞–±–ª—é–¥–∞–µ–º, —á—Ç–æ —Å –±–æ–ª—å—à–∏–º –æ—Ç—Ä—ã–≤–æ–º –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∫–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤ –¶–ê–û:
    - –≤ —Ü–µ–Ω—Ç—Ä–µ –±–æ–ª—å—à–æ–µ –∫–æ–ª-–≤–æ —Ç—É—Ä–∏—Å—Ç–æ–≤;
    - –≤ —Ü–µ–Ω—Ç—Ä –µ–¥–µ—Ç –±–æ–ª—å—à–µ–µ —á–∞—Å—Ç—å –ª—é–¥–µ–π –æ—Ç–¥—ã—Ö–∞—Ç—å;
    - –≤ —Ü–µ–Ω—Ç—Ä –±–æ–ª—å—à–æ–µ –∫–æ–ª-–≤–æ —Ä–∞–∑–≤–µ–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π (—Ç–µ–∞—Ç—Ä—ã, –ø–∞—Ä–∫–∏, –ø—Ä–æ–≥—É–ª–æ—á–Ω—ã–µ —É–ª–∏—Ü—ã –∏ —Ç.–¥.);
- —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `–∫–∞—Ñ–µ`, `–∫–æ—Ñ–µ–π–Ω–∏`, `—Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã`;
- –Ω–∞ —Å–∞–º–æ–º –ø–æ—Å–ª–µ–¥–Ω–µ–º –º–µ—Å—Ç–µ –ø–æ –∫–æ–ª-–≤—É –∑–∞–≤–µ–¥–µ–Ω–∏–π –∑–∞–Ω–∏–º–∞—é—Ç `—Å—Ç–æ–ª–æ–≤—ã–µ`.

<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–°–æ–≥–ª–∞—Å–µ–Ω, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–∂–∏–¥–∞–µ–º—ã–π –¶–ê–û –≤ –ª–∏–¥–µ—Ä–∞—Ö
</div>

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
<a id='Ratings'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b>–ó–ê–î–ê–ß–ê.</b> –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∑–∞–≤–µ–¥–µ–Ω–∏–π. –û—Ç–≤–µ—Ç–∏–º –Ω–∞ –≤–æ–ø—Ä–æ—Å: —Å–∏–ª—å–Ω–æ –ª–∏ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–∞—Ö –æ–±—â–µ–ø–∏—Ç–∞?
"""

#—Å–æ–∑–¥–∞–¥–∏–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –ø–æ —Å—Ä–µ–¥–Ω–∏–º —Ä–µ–π—Ç–∏–Ω–≥–∞–º –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∑–∞–≤–µ–¥–µ–Ω–∏–π
rating = catering.pivot_table(index = 'category', values = 'rating', aggfunc = 'mean')
rating = rating.round(2)
rating = rating.rename(columns={'rating': 'mean_rating'})
rating = rating.reset_index()
rating = rating.sort_values(by='mean_rating', ascending=False)

#–≤—ã–≤–µ–¥–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
rating

"""<b>–ü–æ–¥–∏—Ç–æ–≥:</b>

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –∫–∞—Ñ–µ, –∫–æ—Ñ–µ–π–Ω–∏ –∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã —É –Ω–∞—Å –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø–æ—á—Ç–∏ –≤–µ–∑–¥–µ –Ω–∞ –ø–µ—Ä–≤—ã—Ö –º–µ—Å—Ç–∞—Ö, –Ω–∞ –ø–µ—Ä–≤–æ–º –º–µ—Å—Ç–µ –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É —Ä–µ–π—Ç–∏–Ω–≥—É –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `–±–∞—Ä—ã, –ø–∞–±—ã`. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–≤—è–∑–∞—Ç—å —Å —Ç–µ–º, —á—Ç–æ –≤ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –±–æ–ª—å—à–æ–π —É–ø–æ—Ä –Ω–∞ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ, –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –±–ª—é–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏.

–í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ.
"""

fig_rating = px.bar(rating,
                              x='mean_rating',
                              y='category',
                              text='mean_rating',
                              color='category',
                              color_discrete_sequence=px.colors.sequential.Viridis)

fig_rating.update_layout(title='–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∑–∞–≤–µ–¥–µ–Ω–∏–π',
                                        title_x = 0.5,
                                        xaxis_title='–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥',
                                        yaxis_title='–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π')

fig_rating.update_xaxes(range=[4, 4.5])

fig_rating.show()

"""<b>–ò—Ç–æ–≥:</b>

–ü–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–º –∞–Ω–∞–ª–∏–∑—É —Ñ–∏–∫—Å–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è:
- –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ –∏–º–µ—é—Ç —Ä–µ—Ç–π—Ç–∏–Ω–≥ –≤—ã—à–µ –∑–Ω–∞—á–µ–Ω–∏—è `4`;
- –∫–∞–∫ –º—ã –∏ –≤–∏–¥–µ–ª–∏ –ø–æ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ, —Å–∞–º—ã–π –≤—ã—Å–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ —É –∑–∞–≤–µ–¥–µ–Ω–∏–π `–±–∞—Ä,–ø–∞–±`;
- —É –∫–∞—Ç–µ–≥–æ—Ä–∏–π `—Ä–µ—Å—Ç–æ—Ä–∞–Ω`, `–∫–æ–π—Ñ–µ–π–Ω—è` –∏ `–ø–∏—Ü—Ü–µ—Ä–∏—è` –∏–º–µ—é—Ç —Ä–∞–∑–Ω–∏—Ü—É –≤ 0,1.

<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–í–µ—Ä–Ω–æ,  –±—Ä–∞—Ç—å –º–µ–¥–∏–∞–Ω—É –ø–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –æ—Ç 1 –¥–æ 5 - –Ω–µ—Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ.
</div>

### –§–æ–Ω–æ–≤–∞—è –∫–∞—Ä—Ç–æ–≥—Ä–∞–º–º–∞ —Å–æ —Å—Ä–µ–¥–Ω–∏–º —Ä–µ–π—Ç–∏–Ω–≥–æ–º –∑–∞–≤–µ–¥–µ–Ω–∏–π –∫–∞–∂–¥–æ–≥–æ —Ä–∞–π–æ–Ω–∞
<a id='Horoplet'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b>–ó–ê–î–ê–ß–ê.</b> –ü–æ—Å—Ç—Ä–æ–∏–º —Ñ–æ–Ω–æ–≤—É—é –∫–∞—Ä—Ç–æ–≥—Ä–∞–º–º—É (—Ö–æ—Ä–æ–ø–ª–µ—Ç) —Å–æ —Å—Ä–µ–¥–Ω–∏–º —Ä–µ–π—Ç–∏–Ω–≥–æ–º –∑–∞–≤–µ–¥–µ–Ω–∏–π –∫–∞–∂–¥–æ–≥–æ —Ä–∞–π–æ–Ω–∞. –ì—Ä–∞–Ω–∏—Ü—ã —Ä–∞–π–æ–Ω–æ–≤ –ú–æ—Å–∫–≤—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ, —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `admin_level_geomap.geojson`.
"""

#–ø–æ–¥–∫–ª—é—á–∏–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
import json
from folium import Map, Choropleth

#—Å–æ—Ö—Ä–∞–Ω–∏–º –¥–∞—Ç–∞—Å–µ—Ç –∏–∑ —Ñ–∞–π–ª–∞ 'admin_level_geomap.geojson' –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
try:
    with open('/datasets/admin_level_geomap.geojson', 'r') as file:
        admin_level_geomap = json.load(file)
except:
    with open('/content/drive/MyDrive/datasets_YaP/admin_level_geomap.geojson', 'r') as file:
        admin_level_geomap = json.load(file)

#–ø–æ—Å—Ç—Ä–æ–∏–º —Ç–∞–±–ª–∏—Ü—É —Å–æ —Å—Ä–µ–¥–Ω–∏–º —Ä–µ–π—Ç–∏–Ω–≥–æ–º –∫–∞–∂–¥–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏—è
geo_rating = catering.pivot_table(index = 'district', values = 'rating', aggfunc = 'mean')
geo_rating = geo_rating.round(2)
geo_rating = geo_rating.rename(columns={'rating': 'mean_rating'})
geo_rating = geo_rating.reset_index()
geo_rating = geo_rating.sort_values(by='mean_rating', ascending=False)

#–≤—ã–µ–¥–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
geo_rating

# –∑–∞–≥—Ä—É–∂–∞–µ–º JSON-—Ñ–∞–π–ª —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ –æ–∫—Ä—É–≥–æ–≤ –ú–æ—Å–∫–≤—ã
try:
    district_geo = '/content/drive/MyDrive/datasets_YaP/admin_level_geomap.geojson'
except:
    district_geo = '/datasets/admin_level_geomap.geojson'

# moscow_lat - —à–∏—Ä–æ—Ç–∞ —Ü–µ–Ω—Ç—Ä–∞ –ú–æ—Å–∫–≤—ã, moscow_lng - –¥–æ–ª–≥–æ—Ç–∞ —Ü–µ–Ω—Ç—Ä–∞ –ú–æ—Å–∫–≤—ã
moscow_lat, moscow_lng = 55.751244, 37.618423

# —Å–æ–∑–¥–∞—ë–º –∫–∞—Ä—Ç—É –ú–æ—Å–∫–≤—ã
m = Map(location=[moscow_lat, moscow_lng], zoom_start=10)

# —Å–æ–∑–¥–∞—ë–º —Ö–æ—Ä–æ–ø–ª–µ—Ç —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏ –¥–ª—è —Ü–≤–µ—Ç–æ–≤–æ–π –ø–∞–ª–∏—Ç—Ä—ã
Choropleth(
    geo_data=district_geo,
    data=geo_rating,
    columns=['district', 'mean_rating'],
    key_on='feature.name',
    fill_color='RdYlGn',
    fill_opacity=0.5,
    line_opacity=0.2,
    legend_name='–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ —Ä–∞–π–æ–Ω–∞–º',
).add_to(m)

# –≤—ã–≤–æ–¥–∏–º –∫–∞—Ä—Ç—É
m

"""<div class="alert alert-block alert-danger">‚úç
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –ø—Ä–æ–µ–∫—Ç–∞, –µ–≥–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≥–Ω–∞—Ç—å –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –Ø–ü
</div>

<div class="alert alert-info"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –í—Ä–æ–¥–µ –∏—Å–ø—Ä–∞–≤–∏–ª –∏ –ø—Ä–æ–≥–Ω–∞–ª –≤ –Ø–ü, –æ—Ç—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –≤—Å–µ –∫–∞—Ä—Ç—ã –≤–∏–¥–Ω—ã.</div>

<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ2__

–ó–¥–æ—Ä–æ–≤–æ, —á—Ç–æ —Ä–∞–∑–æ–±—Ä–∞–ª–∏—Å—å)
    
</div>

<b>–ò—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏ —Ö–æ—Ä–æ–ø–ª–µ—Ç—É –º—ã –Ω–∞–±–ª—é–¥–∞–µ–º —Å–ª–µ–¥—É—é—â–µ–µ:
- –≤—Å–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ –ø–æ —Ä–∞–π–æ–Ω–∞–º –≤—ã—à–µ 4—Ö;
- –Ω–∞–∏–≤—ã—Å—à–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –≤ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ - 4,38;
- –Ω–∞–∏–º–µ–Ω—å—à–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –≤ –Æ–≥–æ-–í–æ—Å—Ç–æ—á–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ -4,1.

### –í—Å–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞
<a id='All_zavedeniya'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b>–ó–ê–î–ê–ß–ê.</b> –û—Ç–æ–±—Ä–∞–∑–∏–º –≤—Å–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç–µ —Å –ø–æ–º–æ—â—å—é –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `folium`.
"""

# –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É –∏ –º–∞—Ä–∫–µ—Ä
from folium import Map, Marker
# –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª–∞—Å—Ç–µ—Ä
from folium.plugins import MarkerCluster

# moscow_lat - —à–∏—Ä–æ—Ç–∞ —Ü–µ–Ω—Ç—Ä–∞ –ú–æ—Å–∫–≤—ã, moscow_lng - –¥–æ–ª–≥–æ—Ç–∞ —Ü–µ–Ω—Ç—Ä–∞ –ú–æ—Å–∫–≤—ã
moscow_lat, moscow_lng = 55.751244, 37.618423

# —Å–æ–∑–¥–∞—ë–º –∫–∞—Ä—Ç—É –ú–æ—Å–∫–≤—ã
m = Map(location=[moscow_lat, moscow_lng], zoom_start=10)
# —Å–æ–∑–¥–∞—ë–º –ø—É—Å—Ç–æ–π –∫–ª–∞—Å—Ç–µ—Ä, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ –∫–∞—Ä—Ç—É
marker_cluster = MarkerCluster().add_to(m)

# –ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—Ç—Ä–æ–∫—É –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞,
# —Å–æ–∑–¥–∞—ë—Ç –º–∞—Ä–∫–µ—Ä –≤ —Ç–µ–∫—É—â–µ–π —Ç–æ—á–∫–µ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ –∫–ª–∞—Å—Ç–µ—Ä marker_cluster
def create_clusters(row):
    Marker(
        [row['lat'], row['lng']],
        popup=f"{row['name']} {row['rating']}",
    ).add_to(marker_cluster)

# –ø—Ä–∏–º–µ–Ω—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é create_clusters() –∫ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞
catering.apply(create_clusters, axis=1)

# –≤—ã–≤–æ–¥–∏–º –∫–∞—Ä—Ç—É
m

"""<b>–ò—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º—ã —Å–Ω–æ–≤–∞ –Ω–∞–±–ª—é–¥–∞–µ–º, —á—Ç–æ –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –∑–∞–≤–µ–¥–µ–Ω–∏–π —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–∞ –≤ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ.

<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–û—Ç–ª–∏—á–Ω–æ, —Ö–æ—Ä–æ–ø–ª–µ—Ç –æ—Å–≤–æ–µ–Ω
</div>

### –¢–æ–ø-15 —É–ª–∏—Ü –ø–æ –∫–æ–ª-–≤—É –∑–∞–≤–µ–¥–µ–Ω–∏–π
<a id='Top-15_ulits'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b>–ó–ê–î–ê–ß–ê.</b>–ù–∞–π–¥–µ–º —Ç–æ–ø-15 —É–ª–∏—Ü –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–≤–µ–¥–µ–Ω–∏–π. –ü–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–≤–µ–¥–µ–Ω–∏–π –∏ –∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ —ç—Ç–∏–º —É–ª–∏—Ü–∞–º. –ü–æ–ø—Ä–æ–±—É–µ–º –ø—Ä–æ–∏–ª–ª—é—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–¥–Ω–∏–º –≥—Ä–∞—Ñ–∏–∫–æ–º.

–¢–∞–∫–∂–µ –Ω–∞–π–¥–µ–º —É–ª–∏—Ü—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç –æ–±—â–µ–ø–∏—Ç–∞. –°—Ñ–æ—Ä–º–∏–ª—É—Ä–∏–µ–≤ –≤—ã–≤–æ–¥—ã –æ–± —ç—Ç–∏—Ö –∑–∞–≤–µ–¥–µ–Ω–∏—è—Ö.
"""

#—Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º —Ç–∞–±–ª–∏—Ü—É —Å —Ç–æ–µ-15 —É–ª–∏—Ü –ú–æ—Å–∫–≤—ã –ø–æ –∫–æ–ª-–≤—É —É–ª–∏—Ü—É
top_15_st = catering['street'].value_counts().reset_index().head(15)
top_15_st.columns = ['name_st', 'count']

#–≤—ã–≤–µ–¥–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
top_15_st

#–ø–æ—Å—Ç—Ä–æ–∏–º —Ç–∞–±–ª–∏—Ü—É –ø–æ —É–ª–∏—Ü–∞–º —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π
st_category = catering.pivot_table(index = ['street', 'category'],  values = 'name', aggfunc = 'count')
st_category = st_category.rename(columns={'name': 'count'})
st_category = st_category.reset_index()
st_category = st_category.sort_values(by='count', ascending=False)

#–≤—ã–≤–µ–¥–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
st_category

#–æ—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–∞–±–ª–∏—Ü—É st_category –ø–æ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ —Ç–æ–ø-15 top_15_st
st_15_category = st_category[st_category['street'].isin(top_15_st['name_st'])]

#–≤—ã–≤–µ–¥–∏–º —Ç–∞–±–ª–∏—Ü—É
st_15_category

#–ø–æ—Å—Ç—Ä–æ–∏–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é
fig = px.bar(st_15_category,
                   x='count',
                   y='street',
                   color='category',
                   color_discrete_sequence=px.colors.qualitative.Bold)

fig.update_layout(title='–ö–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –Ω–∞ –¢–æ–ø-15 —É–ª–∏—Ü–∞—Ö',
                             title_x=0.5,
                             xaxis_title='–ö–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π',
                             yaxis_title='–£–ª–∏—Ü—ã',
                             yaxis={'categoryorder':'total ascending'})

fig.show()

"""<b>–ü–æ–¥–∏—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–º —Ç–∞–±–ª–∏—Ü–∞–º –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º—ã –Ω–∞–±–ª—é–¥–∞–µ–º —Å–ª–µ–¥—É—é—â–µ–µ:
- —Å–∞–º–æ–µ –±–æ–ª—å—à–æ–µ –∫–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∞ `–ü—Ä–æ—Å–ø–µ–∫—Ç–µ –º–∏—Ä–∞`;
- —Å–∞–º–æ–µ –º–µ–Ω—å—à–µ–µ –∫–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∞ `—É–ª–∏—Ü–∞ –ü—è—Ç–Ω–∏—Ü–∞`;
- –Ω–∞ –ø–µ—Ä–≤–æ–º –º–µ—Å—Ç–µ —Å—Ä–µ–¥–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞—Ö–æ–¥–∏—è—Å—è `–∫–∞—Ñ–µ` –Ω–∞ —É–∂–µ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –Ω–∞–º–∏ —É–ª–∏—Ü–µ `–ü—Ä–æ—Å–ø–µ–∫—Ç –º–∏—Ä–∞`, –∞ —Ç–∞–∫–∂–µ –≤–¥–æ–ª—å `–ú–ö–ê–î`;
- —Ç–∞–∫–∂–µ —Å–∞–º—ã–º–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ —è–≤–ª—è—é—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `—Ä–µ—Å—Ç–æ—Ä–∞–Ω` –∏ `–∫–æ—Ñ–µ–π–Ω—è`.

–¢–µ–ø–µ—Ä—å –Ω–∞–π–¥–µ–º —É–ª–∏—Ü—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç –æ–±—â–µ–ø–∏—Ç–∞.
"""

#–ø–æ—Å—Ç—Ä–æ–∏–º —Ç–∞–±–ª–∏—Ü—É —Å —É–ª–∏—Ü–∞–º–∏ –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –∑–∞–≤–µ–¥–µ–Ω–∏–µ
one_catering = catering['street'].value_counts().reset_index()
one_catering.columns = ['street', 'count']
one_catering = one_catering.query('count == 1')

#–≤—ã–≤–µ–¥–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
one_catering

#–¥–æ–±–∞–≤–∏–º –∫ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —É–∑–Ω–∞–µ–º –∫–∞–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ –∫–æ–ª-–≤–µ –æ–¥–Ω–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏—è –Ω–∞ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —É–ª–∏—Ü–∞—Ö
one_catering_category = st_category[st_category['street'].isin(one_catering['street'])] \
                                                                                            .groupby('category')['street'] \
                                                                                            .count() \
                                                                                            .reset_index(name='count') \
                                                                                            .sort_values(by='count', ascending=False)

#–≤—ã–≤–µ–¥–∏–º —Ç–∞–±–ª–∏—Ü—É
one_catering_category

"""<b>–ò—Ç–æ–≥:</b>

–ü–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–º—É –∞–Ω–∞–ª–∏–∑—É —Ñ–∏–∫—Å–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è:
- —Å–∞–º–æ–µ –±–æ–ª—å—à–æ–µ –∫–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∞ `–ü—Ä–æ—Å–ø–µ–∫—Ç–µ –º–∏—Ä–∞`;
- —Å–∞–º–æ–µ –º–µ–Ω—å—à–µ–µ –∫–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∞ `—É–ª–∏—Ü–∞ –ü—è—Ç–Ω–∏—Ü–∞`;
- –Ω–∞ –ø–µ—Ä–≤–æ–º –º–µ—Å—Ç–µ —Å—Ä–µ–¥–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞—Ö–æ–¥–∏—è—Å—è `–∫–∞—Ñ–µ` –Ω–∞ —É–∂–µ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –Ω–∞–º–∏ —É–ª–∏—Ü–µ `–ü—Ä–æ—Å–ø–µ–∫—Ç –º–∏—Ä–∞`, –∞ —Ç–∞–∫–∂–µ –≤–¥–æ–ª—å `–ú–ö–ê–î`;
- —Ç–∞–∫–∂–µ —Å–∞–º—ã–º–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ —è–≤–ª—è—é—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `—Ä–µ—Å—Ç–æ—Ä–∞–Ω` –∏ `–∫–æ—Ñ–µ–π–Ω—è`.
- –≤—Å–µ–≥–æ `457 `, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤—Å–µ–≥–æ –æ–¥–Ω–æ –∑–∞–≤–µ–¥–µ–Ω–∏–µ;
- –ø–æ –æ–¥–Ω–æ–º—É –∑–∞–≤–µ–¥–µ–Ω–∏—é –Ω–∞ —É–ª–∏—Ü–∞—Ö –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∑–∞–≤–µ–¥–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `–∫–∞—Ñ–µ`.

### –ú–µ–¥–∏–∞–Ω–∞ —Å—Ä–µ–¥–Ω–∏—Ö —á–µ–∫–æ–≤ –∑–∞–≤–µ–¥–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–π–æ–Ω–∞
<a id='Sredniy_chek'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b>–ó–ê–î–ê–ß–ê.</b> –ó–Ω–∞—á–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–∏—Ö —á–µ–∫–æ–≤ –∑–∞–≤–µ–¥–µ–Ω–∏–π —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Å—Ç–æ–ª–±—Ü–µ middle_avg_bill. –≠—Ç–∏ —á–∏—Å–ª–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–∏–º–µ—Ä–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞ –≤ —Ä—É–±–ª—è—Ö, –∫–æ—Ç–æ—Ä–∞—è —á–∞—â–µ –≤—Å–µ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º. –ü–æ—Å—á–∏—Ç–∞–µ–º –º–µ–¥–∏–∞–Ω—É —ç—Ç–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–π–æ–Ω–∞. –ò—Å–ø–æ–ª—å–∑—É–µ–º —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ü–µ–Ω–æ–≤–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ —Ä–∞–π–æ–Ω–∞. –ü–æ—Å—Ç—Ä–æ–∏–º —Ñ–æ–Ω–æ–≤—É—é –∫–∞—Ä—Ç–æ–≥—Ä–∞–º–º—É (—Ö–æ—Ä–æ–ø–ª–µ—Ç) —Å –ø–æ–ª—É—á–µ–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–π–æ–Ω–∞. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ü–µ–Ω—ã –≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ –∏ –¥—Ä—É–≥–∏—Ö. –û—Ç–≤–µ—Ç–∏–º –Ω–∞ –≤–æ–ø—Ä–æ—Å –∫–∞–∫ —É–¥–∞–ª—ë–Ω–Ω–æ—Å—Ç—å –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ü–µ–Ω—ã –≤ –∑–∞–≤–µ–¥–µ–Ω–∏—è—Ö?
"""

#—Å–æ–∑–¥–∞–¥–∏–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Å –º–µ–¥–∏–∞–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Å—Ä–µ–¥–Ω–∏—Ö —á–µ–∫–æ–≤ –∑–∞–≤–µ–¥–µ–Ω–∏–π
avg_bill_median = catering.pivot_table(index = ['district'],  values = 'middle_avg_bill', aggfunc = 'median')
avg_bill_median = avg_bill_median.rename(columns={'middle_avg_bill': 'bill_median'})
avg_bill_median = avg_bill_median.reset_index()
avg_bill_median = avg_bill_median.sort_values(by='bill_median', ascending=False)

#–≤—ã–≤–µ–¥–∏–º —Ç–∞–±–ª–∏—Ü—É
avg_bill_median

# —Å–æ–∑–¥–∞—ë–º –∫–∞—Ä—Ç—É –ú–æ—Å–∫–≤—ã
m_2 = Map(location=[moscow_lat, moscow_lng], zoom_start=10)

# —Å–æ–∑–¥–∞—ë–º —Ö–æ—Ä–æ–ø–ª–µ—Ç —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ Choropleth –∏ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ –∫–∞—Ä—Ç—É
Choropleth(
    geo_data=district_geo,
    data=avg_bill_median,
    columns=['district', 'bill_median'],
    key_on='feature.name',
    fill_color='RdYlGn',
    fill_opacity=0.5,
    line_opacity=0.2,
    legend_name='–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ —Ä–∞–π–æ–Ω–∞–º',
).add_to(m_2)

# –≤—ã–≤–æ–¥–∏–º –∫–∞—Ä—Ç—É
m_2

"""<div class="alert alert-block alert-danger">‚úç
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ

<div class="alert alert-info"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ, –∫–∞–∫ –≥–æ–≤–æ—Ä–∏–ª —Ä–∞–Ω–µ–µ. –ö–∞—Ä—Ç—ã –≤–∏–¥–Ω—ã.</div>

<b>–ò—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º—ã –Ω–∞–±–ª—é–¥–∞–µ–º —Å–ª–µ–¥—É—é—â–µ–µ:
- —Å–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –≤ `–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ` –∏ `–ó–∞–ø–∞–¥–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ`;
- –Ω–∞–∏–º–µ–Ω—å—à–∏–π —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –≤ `–Æ–≥–æ-–í–æ—Å—Ç–æ—á–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ`;
- —Ä–∞–∑–Ω–∏—Ü–∞ –≤ —Å—Ä–µ–¥–Ω–∏—Ö —á–µ–∫–∞—Ö —Å `–¶–ê–û` –∏ `–ó–ê–û` –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –¥—Ä—É–≥–∏–º–∏ —Ä–∞–π–æ–Ω–∞–º–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤ 1,5-2 —Ä–∞–∑–∞.

<b>–í–´–í–û–î:</b>

–ü–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–º—É –∞–Ω–∞–ª–∏–∑—É –º—ã —Ñ–∏–∫—Å–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –æ–±—â–∏–µ –≤—ã–≤–æ–¥—ã.

1. –ú—ã –ø—Ä–æ–≤–µ–ª–∏ –ø–æ–¥—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–º –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª–∏ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ. –ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–º—É –∞–Ω–∞–ª–∏–∑—É –º—ã –ø–æ–ª—É—á–∏–ª–∏ —Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:
    - –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤ –ú–æ—Å–∫–≤–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∫–∞—Ñ–µ - `28,3 %`;
    - —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã –∑–∞–Ω–∏–º–∞—é—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ–µ –≤—Ç–æ—Ä–æ–µ –º–µ—Å—Ç–æ - `24,3 %`;
    - –∫–æ—Ñ–µ–π–Ω–∏ –∑–∞–Ω–∏–º–∞—é—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ–µ —Ç—Ä–µ—Ç—å–µ –º–µ—Å—Ç–æ - `16,8 %`;
    - –ø—Ä–∏–º–µ—Ä–Ω–æ `25 %` –æ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç "–±–∞—Ä, –ø–∞–±" - `9,09 %`, "–ø–∏—Ü—Ü–µ—Ä–∏—è–º" - `7,53 %`, "–±—ã—Å—Ç—Ä–æ–µ –ø–∏—Ç–∞–Ω–∏–µ" - `7,18 %`;
    - —Å–∞–º–æ–µ –º–µ–Ω—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º: "—Å—Ç–æ–ª–æ–≤–∞—è" - `3,75 %` –∏ "–±—É–ª–æ—á–Ω–∞—è" - `3,05 %`.


2. –ü–æ—Å–ª–µ —á–µ–≥–æ –º—ã –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –ø–æ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤ –ú–æ—Å–∫–≤–µ –∏ –ø–æ–ª—É—á–∏–ª–∏ —Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:
    - —Ç—Ä–æ–π–∫—É –ª–∏–¥–µ—Ä–æ–≤ –ø–æ –º–µ–¥–∏–∞–Ω–Ω–æ–º—É —á–∏—Å–ª—É –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç —É–¥–µ—Ä–∂–∏–≤–∞—é—Ç:
        - `—Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã` - 86 –º–µ—Å—Ç - —ç—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ª—é–¥–∏ –º–æ–≥–ª–∏ –ø—Ä–∏–π—Ç–∏ –∏ —Å–ø–æ–∫–æ–π–Ω–æ –ø–æ—Å–∏–¥–µ—Ç—å –æ—Ç–¥–æ—Ö–Ω—É—Ç—å, –µ—Å–ª–∏ –±—É–¥–µ—Ç –º–∞–ª–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç, —Ç–æ —ç—Ç–æ –º–æ–∂–µ—Ç —Å–∫–∞–∑–∞—Ç—å—Å—è –Ω–∞ —Ä–µ–π—Ç–∏–Ω–≥–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ –º–Ω–æ–≥–æ –Ω–µ–¥–æ–≤–æ–ª—å–Ω—ã—Ö –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –±—É–¥–µ—Ç;
        - `–±–∞—Ä—ã, –ø–∞–±—ã` - 82 –º–µ—Å—Ç–∞ - –¥–∞–Ω–Ω—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–π –∏ —Ç–∞–∫–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç;
        - `–∫–æ—Ñ–µ–π–Ω–∏` - 80 –º–µ—Å—Ç.
    - –¥–∞–ª–µ–µ –∏–¥—É—Ç –∑–∞–≤–µ–¥–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `—Å—Ç–æ–ª–æ–≤–∞—è` - 75 –º–µ—Å—Ç;
    - —Ç–∞–∫ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –æ–±—ã—á–Ω–æ —è–≤–ª—è—é—Ç—Å—è —Å–µ—Ç–µ–≤—ã–º–∏ –∏ –∏—Ö –º–Ω–æ–≥–æ –ø–æ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏, —Ç–æ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º —á–∏—Å–ª–æ–≤–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ:
        - `–±—ã—Å—Ç—Ä–æ–µ –ø–∏—Ç–∞–Ω–∏–µ` - 65 –º–µ—Å—Ç;
        - `–∫–∞—Ñ–µ` - 60 –º–µ—Å—Ç;
        - `–ø–∏—Ü—Ü–µ—Ä–∏—è` - 55 –º–µ—Å—Ç–∞.
    - –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º –º–µ—Å—Ç–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∑–∞–≤–µ–¥–µ–Ω–∏—è —Ç–∏–ø–∞ `–±—É–ª–æ—á–Ω–∞—è` - 50 –º–µ—Å—Ç, –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º, —á—Ç–æ –±—É–ª–æ—á–Ω—ã–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –≤—ã–Ω–æ—Å.


3. –û–ø—Ä–µ–¥–µ–ª–∏–ª–∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–π —Å–µ—Ç–µ–≤—ã—Ö –∫ –Ω–µ—Å–µ—Ç–µ–≤—ã–º –∑–∞–≤–µ–¥–µ–Ω–∏—è–º:
    - `61,9 %` —è–≤–ª—è—é—Ç—Å—è `–ù–µ—Å–µ—Ç–µ–≤—ã–µ` –∑–∞–≤–µ–¥–µ–Ω–∏—è –ú–æ—Å–∫–≤—ã;
    - `38,1 %` —è–≤–ª—è—é—Ç—Å—è `–°–µ—Ç–µ–≤—ã–µ` –∑–∞–≤–µ–¥–µ–Ω–∏—è;
    - –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ, —á—Ç–æ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –±–æ–ª—å—à–µ, –∫—Ä–æ–º–µ:
        - `–ö–æ—Ñ–µ–π–Ω—å` - –°–µ—Ç–µ–≤—ã–µ `720` –∏ –ù–µ—Å–µ—Ç–µ–≤—ã–µ `693`;
        - `–ü–∏—Ü—Ü–µ—Ä–∏–π` - –°–µ—Ç–µ–≤—ã–µ `330` –∏ –ù–µ—Å–µ—Ç–µ–≤—ã–µ `302`;
        - `–ë—É–ª–æ—á–Ω—ã—Ö` - –°–µ—Ç–µ–≤—ã–µ `157` –∏ –ù–µ—Å–µ—Ç–µ–≤—ã–µ `99`.


4. –ü–æ—Å–ª–µ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –≤ –ú–æ—Å–∫–≤–µ,
    - —Å–∞–º—ã–º –ø–æ–ø—É–ª—è—Ä–Ω—ã–º —Å–µ—Ç–µ–≤—ã–º –∑–∞–≤–µ–¥–µ–Ω–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è `–®–æ–∫–æ–ª–∞–¥–Ω–∏—Ü–∞` - 120 –∑–∞–≤–µ–¥–µ–Ω–∏–π;
    - –≤—Ç–æ—Ä–æ–µ –∏ —Ç—Ä–µ—Ç—å–µ –º–µ—Å—Ç–æ –∑–∞ `–î–æ–º–∏–Ω–æ'c –ø–∏—Ü—Ü–∞` –∏ `–î–æ–¥–æ –ø–∏—Ü—Ü–∞` - 76 –∏ 74 –∑–∞–≤–µ–¥–µ–Ω–∏–π;
    - –ø–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –≥—Ä–∞—Ñ–∏–∫–∞–º –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–∫–ª—é—á–µ–Ω–∏—è, —á—Ç–æ –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –≤ –¢–æ–ø-15 - —ç—Ç–æ `–∫–æ—Ñ–µ–π–Ω–∏`, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–æ —Ç–µ–º, —á—Ç–æ —Å–µ—Ç–µ–≤—ã–µ –º–∞–ª–µ–Ω—å–∫–∏–µ –∫–æ—Ñ–µ–π–Ω–∏ –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—â–µ –∏ –±—ã—Å—Ç—Ä–µ–µ;
    - –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ `–î–æ–º–∏–Ω–æ—Å` –∏ `–î–æ–¥–æ –ø–∏—Ü—Ü–∞` –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å –Ω–∞ 2 –∏ 3 —Å—Ç—Ä–æ—á–∫–µ –¢–æ–ø-15 —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π, –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–≤–µ–¥–µ–Ω–∏–π –¥–∞–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –∞ –∏–º–µ–Ω–Ω–æ `–ø–∏—Ü—Ü–µ—Ä–∏—è` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Ç—Ä–µ—Ç—å–µ–º –º–µ—Å—Ç–µ –∏ –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `–∫–æ—Ñ–µ–π–Ω–∏` –æ—Ç—Å—Ç–∞–µ—Ç –ø–æ—á—Ç–∏ –≤ 2-–µ —Ä–∞–∑;
    - –∑–∞–º—ã–∫–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—è `–±—É–ª–æ—á–Ω–∞—è`, –∞ –∏–º–µ–Ω–Ω–æ –æ–¥–Ω–æ —Å–µ—Ç–µ–≤–æ–µ –∑–∞–≤–µ–¥–µ–Ω–∏–µ –≤ –¢–æ–ø-15 `–ë—É—Ö–∞–Ω–∫–∞`, –∫–æ—Ç–æ—Ä–∞—è —è–≤–ª—è–µ—Ç—Å—è —Å–µ—Ç–∫–æ–π, –æ–∫—Ç—Ä—ã–≤–∞—é—â–µ–π—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –≤ –Ω–æ–≤—ã—Ö –ñ–ö –ú–æ—Å–∫–≤–∞, –¥–∞–Ω–Ω–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–µ–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π.


5. –ú—ã –∏–∑—É—á–∏–ª–∏ –¥–∞—Ç–∞—Å–µ—Ç –Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ä–∞–π–æ–Ω—ã –≤ –ú–æ—Å–∫–≤–µ:
    - –≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –≤—Å–µ 9 –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤ –ú–æ—Å–∫–≤—ã:
        - –°–µ–≤–µ—Ä–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–°–ê–û);
        - –°–µ–≤–µ—Ä–æ-–í–æ—Å—Ç–æ—á–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–°–í–ê–û);
        - –°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–°–ó–ê–û);
        - –ó–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–ó–ê–û);
        - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–¶–ê–û);
        - –í–æ—Å—Ç–æ—á–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–í–ê–û);
        - –Æ–≥–æ-–í–æ—Å—Ç–æ—á–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–Æ–í–ê–û);
        - –Æ–∂–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–Æ–ê–û);
        - –Æ–≥–æ-–ó–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥ (–Æ–ó–ê–û).
    - –º—ã –Ω–∞–±–ª—é–¥–∞–µ–º, —á—Ç–æ —Å –±–æ–ª—å—à–∏–º –æ—Ç—Ä—ã–≤–æ–º –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∫–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤ –¶–ê–û:
        - –≤ —Ü–µ–Ω—Ç—Ä–µ –±–æ–ª—å—à–æ–µ –∫–æ–ª-–≤–æ —Ç—É—Ä–∏—Å—Ç–æ–≤;
        - –≤ —Ü–µ–Ω—Ç—Ä –µ–¥–µ—Ç –±–æ–ª—å—à–µ–µ —á–∞—Å—Ç—å –ª—é–¥–µ–π –æ—Ç–¥—ã—Ö–∞—Ç—å;
        - –≤ —Ü–µ–Ω—Ç—Ä –±–æ–ª—å—à–æ–µ –∫–æ–ª-–≤–æ —Ä–∞–∑–≤–µ–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π (—Ç–µ–∞—Ç—Ä—ã, –ø–∞—Ä–∫–∏, –ø—Ä–æ–≥—É–ª–æ—á–Ω—ã–µ —É–ª–∏—Ü—ã –∏ —Ç.–¥.);
    - —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `–∫–∞—Ñ–µ`, `–∫–æ—Ñ–µ–π–Ω–∏`, `—Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã`;
    - –Ω–∞ —Å–∞–º–æ–º –ø–æ—Å–ª–µ–¥–Ω–µ–º –º–µ—Å—Ç–µ –ø–æ –∫–æ–ª-–≤—É –∑–∞–≤–µ–¥–µ–Ω–∏–π –∑–∞–Ω–∏–º–∞—é—Ç `—Å—Ç–æ–ª–æ–≤—ã–µ`.


6. –ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É —Ä–µ–π—Ç–∏–Ω–≥—É –∑–∞–≤–µ–¥–µ–Ω–∏–π –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏, —á—Ç–æ:
    - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ –∏–º–µ—é—Ç —Ä–µ—Ç–π—Ç–∏–Ω–≥ –≤—ã—à–µ –∑–Ω–∞—á–µ–Ω–∏—è `4`;
    - –∫–∞–∫ –º—ã –∏ –≤–∏–¥–µ–ª–∏ –ø–æ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ, —Å–∞–º—ã–π –≤—ã—Å–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ —É –∑–∞–≤–µ–¥–µ–Ω–∏–π `–±–∞—Ä,–ø–∞–±`;
    - —É –∫–∞—Ç–µ–≥–æ—Ä–∏–π `—Ä–µ—Å—Ç–æ—Ä–∞–Ω`, `–∫–æ–π—Ñ–µ–π–Ω—è` –∏ `–ø–∏—Ü—Ü–µ—Ä–∏—è` –∏–º–µ—é—Ç —Ä–∞–∑–Ω–∏—Ü—É –≤ 0,1.


7. –ê —Ç–∞–∫–∂–µ –º—ã –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª–∏ —Å–ª–µ–¥—É—é—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –∞–Ω–∞–ª–∏–∑—É —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –≤ —Ä–∞–π–æ–Ω–∞—Ö –ú–æ—Å–∫–≤—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ö–æ—Ä–æ–ø–ª–µ—Ç–∞:
    - –≤—Å–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ –ø–æ —Ä–∞–π–æ–Ω–∞–º –≤—ã—à–µ 4—Ö;
    - –Ω–∞–∏–≤—ã—Å—à–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –≤ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ - 4,38;
    - –Ω–∞–∏–º–µ–Ω—å—à–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –≤ –Æ–≥–æ-–í–æ—Å—Ç–æ—á–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ -4,1.


8. –ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º—ã –Ω–∞–±–ª—é–¥–∞–µ–º, —á—Ç–æ –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –∑–∞–≤–µ–¥–µ–Ω–∏–π —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–∞ –≤ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ.


9. –ü–æ –∞–Ω–∞–ª–∏–∑—É –¢–æ–ø-15 —É–ª–∏—Ü –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–≤–µ–¥–µ–Ω–∏–π –º—ã –ø–æ–ª—É—á–∏–ª–∏ —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:
    - —Å–∞–º–æ–µ –±–æ–ª—å—à–æ–µ –∫–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∞ `–ü—Ä–æ—Å–ø–µ–∫—Ç–µ –º–∏—Ä–∞`;
    - —Å–∞–º–æ–µ –º–µ–Ω—å—à–µ–µ –∫–æ–ª-–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∞ `—É–ª–∏—Ü–∞ –ü—è—Ç–Ω–∏—Ü–∞`;
    - –Ω–∞ –ø–µ—Ä–≤–æ–º –º–µ—Å—Ç–µ —Å—Ä–µ–¥–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞—Ö–æ–¥–∏—è—Å—è `–∫–∞—Ñ–µ` –Ω–∞ —É–∂–µ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –Ω–∞–º–∏ —É–ª–∏—Ü–µ `–ü—Ä–æ—Å–ø–µ–∫—Ç –º–∏—Ä–∞`, –∞ —Ç–∞–∫–∂–µ –≤–¥–æ–ª—å `–ú–ö–ê–î`;
    - —Ç–∞–∫–∂–µ —Å–∞–º—ã–º–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ —è–≤–ª—è—é—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `—Ä–µ—Å—Ç–æ—Ä–∞–Ω` –∏ `–∫–æ—Ñ–µ–π–Ω—è`.
    - –≤—Å–µ–≥–æ `457 `, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤—Å–µ–≥–æ –æ–¥–Ω–æ –∑–∞–≤–µ–¥–µ–Ω–∏–µ;
    - –ø–æ –æ–¥–Ω–æ–º—É –∑–∞–≤–µ–¥–µ–Ω–∏—é –Ω–∞ —É–ª–∏—Ü–∞—Ö –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∑–∞–≤–µ–¥–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ `–∫–∞—Ñ–µ`.


10. –ê –ø–æ –º–µ–¥–∏–∞–Ω–∞–º —Å—Ä–µ–¥–Ω–∏—Ö —á–µ–∫–æ–≤ –∑–∞–≤–µ–¥–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–π–æ–Ω–∞ –ú–æ—Å–∫–≤—ã –º—ã —Å–¥–µ–ª–∞–ª–∏ —Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–≤–æ–¥—ã:
    - —Å–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –≤ `–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ` –∏ `–ó–∞–ø–∞–¥–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ`;
    - –Ω–∞–∏–º–µ–Ω—å—à–∏–π —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –≤ `–Æ–≥–æ-–í–æ—Å—Ç–æ—á–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ`;
    - —Ä–∞–∑–Ω–∏—Ü–∞ –≤ —Å—Ä–µ–¥–Ω–∏—Ö —á–µ–∫–∞—Ö —Å `–¶–ê–û` –∏ `–ó–ê–û` –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –¥—Ä—É–≥–∏–º–∏ —Ä–∞–π–æ–Ω–∞–º–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤ 1,5-2 —Ä–∞–∑–∞.

<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–≥–∞ —Å–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π, —á—Ç–æ –Ω–µ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ. –ù–µ —Å–∏–ª—å–Ω–æ –ø–æ —Ü–µ–Ω–µ —É—Å—Ç—É–ø–∞–µ—Ç –∏ –ó–∞–ø–∞–¥–Ω—ã–π –æ–∫—Ä—É–≥. –ë—é–¥–∂–µ—Ç–Ω—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –ª–µ–≥—á–µ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å –Æ–ê–û, –Æ–í–ê–û –∏ –°–í–ê–û.
</div>

## –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è: –æ—Ç–∫—Ä—ã—Ç–∏–µ –∫–æ—Ñ–µ–π–Ω–∏
<a id='Opening_of_the_coffee_shop'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

–û—Å–Ω–æ–≤–∞—Ç–µ–ª—è–º —Ñ–æ–Ω–¥–∞ ¬´Shut Up and Take My Money¬ª –Ω–µ –¥–∞—ë—Ç –ø–æ–∫–æ—è —É—Å–ø–µ—Ö —Å–µ—Ä–∏–∞–ª–∞ ¬´–î—Ä—É–∑—å—è¬ª. –ò—Ö –º–µ—á—Ç–∞ ‚Äî –æ—Ç–∫—Ä—ã—Ç—å —Ç–∞–∫—É—é –∂–µ –∫—Ä—É—Ç—É—é –∏ –¥–æ—Å—Ç—É–ø–Ω—É—é, –∫–∞–∫ ¬´Central Perk¬ª, –∫–æ—Ñ–µ–π–Ω—é –≤ –ú–æ—Å–∫–≤–µ. –ë—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –∑–∞–∫–∞–∑—á–∏–∫–∏ –Ω–µ –±–æ—è—Ç—Å—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ –≤ —ç—Ç–æ–π —Å—Ñ–µ—Ä–µ, –≤–µ–¥—å –∫–æ—Ñ–µ–µ–Ω –≤ –±–æ–ª—å—à–∏—Ö –≥–æ—Ä–æ–¥–∞—Ö —É–∂–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –ü–æ–ø—Ä–æ–±—É–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –æ—Å—É—â–µ—Å—Ç–≤–∏–º–∞ –ª–∏ –º–µ—á—Ç–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤.

–í –¥–∞–Ω–Ω–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –º—ã –æ—Ç–≤–µ—Ç–∏–º –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã:
- –°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –∫–æ—Ñ–µ–µ–Ω –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ? –í –∫–∞–∫–∏—Ö —Ä–∞–π–æ–Ω–∞—Ö –∏—Ö –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ, –∫–∞–∫–æ–≤—ã –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏—Ö —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è?
- –ï—Å—Ç—å –ª–∏ –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω—ã–µ –∫–æ—Ñ–µ–π–Ω–∏?
- –ö–∞–∫–∏–µ —É –∫–æ—Ñ–µ–µ–Ω —Ä–µ–π—Ç–∏–Ω–≥–∏? –ö–∞–∫ –æ–Ω–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ —Ä–∞–π–æ–Ω–∞–º?
- –ù–∞ –∫–∞–∫—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å —á–∞—à–∫–∏ –∫–∞–ø—É—á–∏–Ω–æ —Å—Ç–æ–∏—Ç –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∏ –ø–æ—á–µ–º—É?

### –ö–æ—Ñ–µ–π–Ω–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞
<a id='Dataset_coffee_shops'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b>–ó–ê–î–ê–ß–ê.</b> –°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –∫–æ—Ñ–µ–µ–Ω –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ? –í –∫–∞–∫–∏—Ö —Ä–∞–π–æ–Ω–∞—Ö –∏—Ö –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ, –∫–∞–∫–æ–≤—ã –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏—Ö —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è?
"""

#–ø–æ—Å—á–∏—Ç–∞–µ–º —Å–∫–æ–ª—å–∫–æ –∫–æ—Ñ–µ–µ–Ω —É –Ω–∞—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ
coffee_house = catering.query("category == '–∫–æ—Ñ–µ–π–Ω—è'")
print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ñ–µ–µ–Ω –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ: ', len(coffee_house))

"""<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–†–∞—Å—á—ë—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
"""

# —Å–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç—É –ú–æ—Å–∫–≤—ã
moscow_lat = coffee_house['lat'].mean()
moscow_lng = coffee_house['lng'].mean()

m_3 = folium.Map(location=[moscow_lat, moscow_lng], zoom_start=11)

# –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –∫–∞–∂–¥–æ–π –∫–æ—Ñ–µ–π–Ω–∏
location_data = coffee_house[['lat', 'lng']].values.tolist()

# –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ø–∞–ø–∞—Ö –∫–∞–∂–¥–æ–π –∫–æ—Ñ–µ–π–Ω–∏
popup_data = coffee_house[['name', 'rating']].apply(lambda x: f'{x[0]} {x[1]}', axis=1).values.tolist()

# —Å–æ–∑–¥–∞–µ–º –∫–ª–∞—Å—Ç–µ—Ä –º–∞—Ä–∫–µ—Ä–æ–≤ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ –∫–∞—Ä—Ç—É
FastMarkerCluster(data=location_data, popups=popup_data).add_to(m_3)

# –¥–æ–±–∞–≤–ª—è–µ–º –≥—Ä–∞–Ω–∏—Ü—ã –æ–∫—Ä—É–≥–æ–≤ –Ω–∞ –∫–∞—Ä—Ç—É
folium.GeoJson(data=district_geo,
    style_function=lambda x: {
        'fillColor': '#F0FFF0',
        'color': 'gray',
        'weight': 1.5,
        'fillOpacity': 0.3,
    }).add_to(m_3)

#–≤—ã–≤–æ–¥–∏–º –∫–∞—Ä—Ç—É
m_3

"""<b>–ü–æ–¥–∏—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –≤–∏–∑–∞–ª–∏–∑–∞—Ü–∏–∏ –º—ã –Ω–∞–±–ª—é–¥–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é –∫–∞—Ä—Ç–∏–Ω—É:
- –≤—Å–µ–≥–æ –∫–æ—Ñ–µ–µ–Ω –≤ –ú–æ—Å–∫–≤–µ - 1413 –∑–∞–≤–µ–¥–Ω–∏–π;
- –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ñ–µ–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ`;
- –Ω–∞ –≤—Ç–æ—Ä–æ–º –º–µ—Å—Ç–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∫–æ—Ñ–µ–µ–Ω `–Æ–≥–æ-–∑–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥;`
- –Ω–∞ —Ç—Ä–µ—Ç—å–µ–º –º–µ—Å—Ç–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∫–æ—Ñ–µ–µ–Ω –≤ `–°–µ–≤–µ—Ä–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä–≥—É–µ` –∏ `–°–µ–≤–µ—Ä–æ-–∑–∞–ø–∞–¥–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ`.

### –ö—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω—ã–µ –∫–æ—Ñ–µ–π–Ω–∏
<a id='Round-the-clock'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b>–ó–ê–î–ê–ß–ê.</b> –ï—Å—Ç—å –ª–∏ –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω—ã–µ –∫–æ—Ñ–µ–π–Ω–∏?
"""

#–ø–æ—Å—á–∏—Ç–∞–µ–º —Å–∫–æ–ª—å–∫–æ –∫–æ—Ñ–µ–µ–Ω —É –Ω–∞—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ
coffee_house = coffee_house.rename(columns={'is_24/7': 'is_24_7'})
coffee_house_24_7 = coffee_house.query("is_24_7 == True")
print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ñ–µ–µ–Ω –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ: ', len(coffee_house_24_7))

# —Å–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç—É –ú–æ—Å–∫–≤—ã
moscow_lat = coffee_house['lat'].mean()
moscow_lng = coffee_house['lng'].mean()

m_4 = folium.Map(location=[moscow_lat, moscow_lng], zoom_start=11)

# –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –∫–∞–∂–¥–æ–π –∫–æ—Ñ–µ–π–Ω–∏
location_data = coffee_house_24_7[['lat', 'lng']].values.tolist()

# –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ø–∞–ø–∞—Ö –∫–∞–∂–¥–æ–π –∫–æ—Ñ–µ–π–Ω–∏
popup_data = coffee_house_24_7[['name', 'rating']].apply(lambda x: f'{x[0]} {x[1]}', axis=1).values.tolist()

# —Å–æ–∑–¥–∞–µ–º –∫–ª–∞—Å—Ç–µ—Ä –º–∞—Ä–∫–µ—Ä–æ–≤ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ –∫–∞—Ä—Ç—É
FastMarkerCluster(data=location_data, popups=popup_data).add_to(m_4)

# –¥–æ–±–∞–≤–ª—è–µ–º –≥—Ä–∞–Ω–∏—Ü—ã –æ–∫—Ä—É–≥–æ–≤ –Ω–∞ –∫–∞—Ä—Ç—É
folium.GeoJson(data=district_geo,
    style_function=lambda x: {
        'fillColor': '#F0FFF0',
        'color': 'gray',
        'weight': 1.5,
        'fillOpacity': 0.3,
    }).add_to(m_4)

#–≤—ã–≤–æ–¥–∏–º –∫–∞—Ä—Ç—É
m_4

"""<b>–ü–æ–¥–∏—Ç–æ–≥:</b>

–ò–∑ –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –∫–æ—Ñ–µ–µ–Ω `59` —Ä–∞–±–æ—Ç–∞—é—Ç –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ –∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø–æ –±–æ–ª—å—à–µ–π —á–∞—Å—Ç–∏ –≤ `–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ`.

### –†–µ–π—Ç–∏–Ω–≥–∏ –∫–æ—Ñ–µ–µ–Ω
<a id='Rating_of_coffee_shops'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b>–ó–ê–î–ê–ß–ê.</b> –ö–∞–∫–∏–µ —É –∫–æ—Ñ–µ–µ–Ω —Ä–µ–π—Ç–∏–Ω–≥–∏? –ö–∞–∫ –æ–Ω–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ —Ä–∞–π–æ–Ω–∞–º?
"""

#–ø–æ—Å—Ç—Ä–æ–∏–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –ø–æ —Ä–µ–π—Ç–∏–Ω–≥–∞–º –∫–æ—Ñ–µ–µ–Ω –≤ –∫–∞–∂–¥–æ–º —Ä–∞–π–æ–Ω–µ
coffee_ratings = coffee_house.pivot_table(
    index='district',
    values='rating',
    aggfunc='mean'
).round(2).sort_values(
    'rating',
    ascending=False
).reset_index()

#–≤—ã–≤–µ–¥–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
coffee_ratings

# —Å–æ–∑–¥–∞—ë–º –∫–∞—Ä—Ç—É –ú–æ—Å–∫–≤—ã
m_5 = Map(location=[moscow_lat, moscow_lng], zoom_start=10)

# —Å–æ–∑–¥–∞—ë–º —Ö–æ—Ä–æ–ø–ª–µ—Ç —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ Choropleth –∏ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ –∫–∞—Ä—Ç—É
Choropleth(
    geo_data=district_geo,
    data=coffee_ratings,
    columns=['district', 'rating'],
    key_on='feature.name',
    fill_color='RdYlGn',
    fill_opacity=0.5,
    line_opacity=0.2,
    legend_name='–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º —Ä–∞–π–æ–Ω–∞–º –ú–æ—Å–∫–≤—ã',
).add_to(m_5)

# –≤—ã–≤–æ–¥–∏–º –∫–∞—Ä—Ç—É
m_5

"""<b>–ü–æ–¥–∏—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º—ã —Ñ–∏–∫—Å–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–≤–æ–¥—ã:
- —Å–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∫–æ—Ñ–µ–µ–Ω –≤ `–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ` –∏ `–°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ`;
- —Ä–µ–π—Ç–∏–Ω–≥–∏ –∫–æ—Ñ–µ–µ–Ω –≤ –∫–∞–∂–¥–æ–º —Ä–∞–π–æ–Ω–µ –Ω–µ –Ω–∏–∂–µ 4;
- —Å–∞–º—ã–π –Ω–∏–∑–∫–∏–π —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∫–æ—Ñ–µ–µ–Ω –≤ `–ó–∞–ø–∞–¥–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ`.

### –°—Ç–æ–∏–º–æ—Å—Ç–∏ —á–∞—à–∫–∏ –∫–∞–ø—É—á–∏–Ω–æ
<a id='Cup'></a>
–¢–µ–∫—Å—Ç –≤–≤–µ–¥–µ–Ω–∏—è. [–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–∞—á–∞–ª—É](#–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)

<b>–ó–ê–î–ê–ß–ê.</b>–ù–∞ –∫–∞–∫—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å —á–∞—à–∫–∏ –∫–∞–ø—É—á–∏–Ω–æ —Å—Ç–æ–∏—Ç –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∏ –ø–æ—á–µ–º—É?
"""

# –≤—ã—á–∏—Å–ª—è–µ–º —Å—Ä–µ–¥–Ω—é—é —Å—Ç–æ–∏–º–æ—Å—Ç—å —á–∞—à–∫–∏ –∫–æ—Ñ–µ –≤ –∫–∞–∂–¥–æ–º —Ä–∞–π–æ–Ω–µ –ú–æ—Å–∫–≤—ã
cost_cup = coffee_house.pivot_table(
    values='middle_coffee_cup',
    index='district',
    aggfunc='mean'
).reset_index()
cost_cup['middle_coffee_cup'] = cost_cup['middle_coffee_cup'].round(2)

# —Å–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—Ç–æ–∏–º–æ—Å—Ç–∏
cost_cup = cost_cup.sort_values('middle_coffee_cup', ascending=False)

# –≤—ã–≤–æ–¥–∏–º –Ω–∞ —ç–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ —Å—Ä–µ–¥–Ω—é—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤ –ú–æ—Å–∫–≤–µ
display(cost_cup)
print('–°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —á–∞—à–∫–∏ –∫–æ—Ñ–µ –≤ –ú–æ—Å–∫–≤–µ:', round(cost_cup['middle_coffee_cup'].mean(), 2))

# —Å–æ–∑–¥–∞—ë–º –∫–∞—Ä—Ç—É –ú–æ—Å–∫–≤—ã
m_6 = Map(location=[moscow_lat, moscow_lng], zoom_start=10)

# —Å–æ–∑–¥–∞—ë–º —Ö–æ—Ä–æ–ø–ª–µ—Ç —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ Choropleth –∏ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ –∫–∞—Ä—Ç—É
Choropleth(
    geo_data=district_geo,
    data=cost_cup,
    columns=['district', 'middle_coffee_cup'],
    key_on='feature.name',
    fill_color='RdYlGn',
    fill_opacity=0.5,
    line_opacity=0.2,
    legend_name='–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ —á–∞—à–∫–∏ –∫–æ—Ñ–µ –ø–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º —Ä–∞–π–æ–Ω–∞–º –ú–æ—Å–∫–≤—ã',
).add_to(m_6)

# –≤—ã–≤–æ–¥–∏–º –∫–∞—Ä—Ç—É
m_6

"""<b>–ü–æ–¥–∏—Ç–æ–≥:</b>

–ü–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º—ã —Ñ–∏–∫—Å–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–µ–µ:
- —Å–∞–º–∞—è –¥–æ—Ä–æ–≥–∞—è —á–∞—à–∫–∞ –∫–æ—Ñ–µ –≤ `–ó–∞–ø–∞–¥–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ`, `–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ` –∏ `–Æ–≥–æ-–ó–∞–ø–∞–¥–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ`;
- —Å—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å —á–∞—à–∫–∏ –∫–æ—Ñ–µ –ø–æ –≤—Å–µ–π –ú–æ—Å–∫–≤–µ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç `171.32`.

<b>–í—ã–≤–æ–¥:</b>

–û—Ç–∫—Ä—ã—Ç–∏–µ –Ω–æ–≤–æ–π –∫–æ—Ñ–µ–π–Ω–∏ –ø—Ä–µ–¥–ª–∞–≥–∞—é –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏:
- —Å–∞–º—ã–µ –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ä–∞–π–æ–Ω—ã –ú–æ—Å–∫–≤—ã —ç—Ç–æ:
    - `–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥`;
    - `–ó–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥`;
    - `–Æ–≥–æ-–ó–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥`,
    —Ç–∞–∫ –∫–∞–∫ –≤ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–π–æ–Ω–∞—Ö –≤—ã—Å–æ–∫–∞—è —Å—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —á–∞—à–∫–∏ –∫–æ—Ñ–µ, —Ç–æ –µ—Å—Ç—å –º–æ–∂–Ω–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Ö–æ—Ä–æ—à—É—é –ø—Ä–∏–±—ã–ª—å –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏. –ê –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã –Ω–∞ —á–∞—à–∫—É –∫–æ—Ñ–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏—è, —Ç–æ —Å–º–æ–∂–µ–º –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø—Ä–∏—Ä–æ—Å—Ç –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π;
- –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã, –∞ –ª—É—á—à–µ –≤—Å–µ–≥–æ `–ó–∞–ø–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥`, —Ç–∞–∫ –∫–∞–∫ –≤ –¥–∞–Ω–Ω–æ–º —Ä–∞–π–æ–Ω–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ —Ç–∞–∫–∏—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π. –ò–ª–∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥–ª—è —ç—Ç–æ–≥–æ `–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥`, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ —Å–∞–º—ã–µ –ø—Ä–æ—Ö–æ–¥–∏–º—ã–µ —Ä–∞–π–æ–Ω—ã;
- –≤ `–ó–∞–ø–∞–¥–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ` –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –Ω–∏–∑–∫–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∫–æ—Ñ–µ–µ–Ω, —á—Ç–æ –º–æ–∂–µ—Ç —Å—ã–≥—Ä–∞—Ç—å –Ω–∞ —Ä—É–∫—É –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–∏ –≤ –¥–∞–Ω–Ω–æ–º —Ä–∞–π–æ–Ω–µ –ú–æ—Å–∫–≤—ã.

<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1__

–ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ç–≤–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤ —Ö–æ–¥–µ –∞–Ω–∞–ª–∏–∑–∞, –Ω–æ —Å–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ - –¥–∞–Ω—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∑–∞–∫–∞–∑—á–∏–∫—É. –≠—Ç–æ –≤–∞–∂–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞. –†–∞–∑–≤–∏–≤–∞–π –µ–≥–æ –∏ –¥–∞–ª—å—à–µ
</div>

<b>–°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–æ–µ–∫—Ç–∞:</b> https://disk.yandex.ru/d/3C2GqQjw5AY1cQ

<div class="alert alert-block alert-warning">üìù
–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ1 </b>

---
–£ —Ç–µ–±—è –ø–æ–ª—É—á–∏–ª–∞—Å—å –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–∞—è –∏ —Ö–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞. –ó–¥–æ—Ä–æ–≤–æ, —á—Ç–æ —Ä–∞—Å—á–µ—Ç—ã —Ç—ã —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—à—å –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è–º–∏, –∞ —Ç–∞–∫ –∂–µ –Ω–µ –∑–∞–±—ã–≤–∞–µ—à—å –ø—Ä–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å.

---

***–ù—É–∂–Ω–æ –ø–æ–ø—Ä–∞–≤–∏—Ç—å:***

1) –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ –∫–æ–¥–µ

2) –¢–∏–ø—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤

3) –ü–æ–ø—Ä–∞–≤–∏—Ç—å –≤—ã–≤–æ–¥—ã –∏ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –ø–æ—Å–ª–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏


---


***–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è —Å–¥–µ–ª–∞–Ω–∞ —Ö–æ—Ä–æ—à–æ, –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ—Ä–∞–¥–æ–≤–∞–ª–æ:***

* –µ—ë —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ—Å—Ç—å

* –û–¥–∏–Ω —Å–ª–∞–π–¥-–æ–¥–Ω–∞ –º—ã—Å–ª—å. –ò–¥–µ–∞–ª—å–Ω–æ =) üòä

* –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å

* –æ–±—â–∏–π –≤—ã–≤–æ–¥

* —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

***–ö–∞–∫ –µ—ë –Ω—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:***



* –ù—É–º–µ—Ä–∞—Ü–∏—è —Å–ª–∞–π–¥–æ–≤


–î–∞–≤–∞–π –ø–æ–ø—Ä–∞–≤–∏–º –º–æ–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –±—É–¥–µ–º –¥–≤–∏–≥–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ.

---

–£ –Ø–Ω–¥–µ–∫—Å –ü—Ä–∞–∫—Ç–∏–∫—É–º–∞ –µ—Å—Ç—å –æ—Ç–ª–∏—á–Ω—ã–π –∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫—É—Ä—Å –ø–æ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è–º. –°–æ–≤–µ—Ç—É—é, –≤ —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è –æ—Å–≤–æ–∏—Ç—å –µ–≥–æ (https://practicum.yandex.ru/profile/visual-presentation/)


---


–ï—Å–ª–∏ —É —Ç–µ–±—è –±—É–¥—É—Ç –∫–∞–∫–∏–µ-—Ç–æ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –º–æ–∏–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–∏—à–∏! –ë—É–¥—É –∂–¥–∞—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ä–µ–≤—å—é :)</div>

<div class="alert alert-info"> <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞:</b> –°–ø–∞—Å–∏–±–æ —Ç–µ–±–µ –æ–≥—Ä–æ–º–Ω–æ–µ, –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –≤–Ω–µ—Å, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã –ø—Ä–æ—Å–∏–ª. –¢–∞–∫–∂–µ –ø–æ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞–º –ø–æ–ø—Ä–∞–≤–∏–ª –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é, –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ª–µ–∂–∞—Ç –ø–æ —Å—Å—ã–ª–∫–µ.

<div style="border:solid blue 3px; padding: 20px">
<div class="alert alert-block alert-success">‚úîÔ∏è
    

__–ö–æ–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç —Ä–µ–≤—å—é–µ—Ä–∞ ‚Ññ2__

    
–î–µ–Ω–∏—Å, —ç—Ç–æ —Ç–µ–µ–± —Å–ø–∞—Å–∏–±–æ –∑–∞ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –∏ –ø—Ä–∞–≤–∫–∏)    
    
---    
    
–í –æ—Å—Ç–∞–ª—å–Ω–æ–º –≤—Å—ë —á—É–¥–Ω–æüòä. –¢–≤–æ–π –ø—Ä–æ–µ–∫—Ç —Ç–∞–∫ –∏ –ø—Ä–æ—Å–∏—Ç—Å—è –Ω–∞ github =)   
    
–ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Å —É—Å–ø–µ—à–Ω—ã–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º –ø—Ä–æ–µ–∫—Ç–∞ üòäüëç
–ò –∂–µ–ª–∞—é —É—Å–ø–µ—Ö–æ–≤ –≤ –Ω–æ–≤—ã—Ö —Ä–∞–±–æ—Ç–∞—Ö üòä

---

–û—Ç —Å–µ–±—è —Ö–æ—á—É –ø–æ—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å —Ç–µ–±–µ –æ—Ç–ª–∏—á–Ω—ã–π –º–µ—Ç–µ—Ä–∏–∞–ª –ø—Ä–æ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.
    
* **–ö–Ω–∏–≥–∞ –ì—Ä–∞—Ñ–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–±–µ–∂–¥–∞—é—Ç –≤—Å–µ—Ö | –ê. –ë–æ–≥–∞—á–µ–≤**
    
* **–ö—É—Ä—Å –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø—Ä–æ—Ñ–µ—Å—Å–∏–π (free): https://practicum.yandex.ru/visual-presentation/**
"""

